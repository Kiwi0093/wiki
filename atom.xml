<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kiwi&#39;s Wiki</title>
  
  
  <link href="http://kiwi0093.github.io/wiki/atom.xml" rel="self"/>
  
  <link href="http://kiwi0093.github.io/wiki/"/>
  <updated>2024-03-22T09:21:40.701Z</updated>
  <id>http://kiwi0093.github.io/wiki/</id>
  
  <author>
    <name>Kiwi</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Tmux + Oh My Tmux</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Misc/Tmux/1-Tmux+oh-my-tmux/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Misc/Tmux/1-Tmux+oh-my-tmux/</id>
    <published>2024-03-22T08:52:20.422Z</published>
    <updated>2024-03-22T09:21:40.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>以前我很喜歡用<code>screen</code>指令，不過現在都改用tmux,加上oh-my-tmux後整個就高大上了</p><span id="more"></span><h1 id="基本安裝"><a class="markdownIt-Anchor" href="#基本安裝"></a> 基本安裝</h1><h2 id="tmux"><a class="markdownIt-Anchor" href="#tmux"></a> tmux</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S tmux</span><br></pre></td></tr></table></figure><p>這個基本上沒難度</p><h2 id="oh-my-tmux"><a class="markdownIt-Anchor" href="#oh-my-tmux"></a> oh-my-tmux</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">git clone https://github.com/gpakosz/.tmux.git</span><br><span class="line">ln -s -f .tmux/.tmux.conf</span><br><span class="line">cp .tmux/.tmux.conf.local .</span><br></pre></td></tr></table></figure><h1 id="基本使用"><a class="markdownIt-Anchor" href="#基本使用"></a> 基本使用</h1><h2 id="hotkey"><a class="markdownIt-Anchor" href="#hotkey"></a> Hotkey</h2><table><thead><tr><th>Hotkey</th><th>按鍵方式</th><th>內容</th></tr></thead><tbody><tr><td>Prefix</td><td>Ctl+a or Ctl+b</td><td>組合鍵起手勢</td></tr><tr><td>Prefix C-c</td><td>Ctl+a -&gt; Ctl+c</td><td>開一個新的Session</td></tr><tr><td>Prefix -</td><td>Ctl+a -&gt; -</td><td>開一個垂直的Pane</td></tr><tr><td>Prefix _</td><td>Ctl+a -&gt; _</td><td>開一個水平的Pane</td></tr><tr><td>Prefix m</td><td>Ctl+a -&gt; m</td><td>開啟/關閉滑鼠</td></tr><tr><td>Prefix ,</td><td>Ctl+a -&gt; .</td><td>重新命名這個Session</td></tr></tbody></table>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;以前我很喜歡用&lt;code&gt;screen&lt;/code&gt;指令，不過現在都改用tmux,加上oh-my-tmux後整個就高大上了&lt;/p&gt;</summary>
    
    
    
    <category term="Misc" scheme="http://kiwi0093.github.io/wiki/categories/Misc/"/>
    
    <category term="Tmux" scheme="http://kiwi0093.github.io/wiki/categories/Misc/Tmux/"/>
    
    
    <category term="Markdown" scheme="http://kiwi0093.github.io/wiki/tags/Markdown/"/>
    
  </entry>
  
  <entry>
    <title>WSL &amp; WSLg Tips for ArchWSL</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Linux/WSL/3-WSL_&amp;_WSLg_Tip_for_ArchWSL/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Linux/WSL/3-WSL_&amp;_WSLg_Tip_for_ArchWSL/</id>
    <published>2024-03-22T03:04:05.152Z</published>
    <updated>2024-03-22T09:25:53.202Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>現在<code>WSLg</code>基本上已經內建在WSL安裝內，所以不再需要弄個<code>GWSL</code>來進行設定<br />順便紀錄一下<code>ArchWSL</code>的一些設定以免忘記</p><span id="more"></span><h1 id="basic-setting"><a class="markdownIt-Anchor" href="#basic-setting"></a> Basic Setting</h1><p>基本上沒打算用GUI的同學只需要弄這塊就好了</p><h2 id="archlinux-keyring"><a class="markdownIt-Anchor" href="#archlinux-keyring"></a> Archlinux-keyring</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化keyring</span></span><br><span class="line">sudo pcaman-keyring --init</span><br><span class="line"><span class="comment"># Poplutae keyring</span></span><br><span class="line">sudo pacman-keyring --populate</span><br><span class="line"><span class="comment"># 套用及更新 (若需要調整mirrorlist，可以先修改/etc/pacman.d/mirrorlist)</span></span><br><span class="line">sudo pacman -Syu</span><br></pre></td></tr></table></figure><p>這一步驟是ArchWSL必備的，不然沒有正確的keyring什麼都沒辦法裝</p><h2 id="etcwslconf"><a class="markdownIt-Anchor" href="#etcwslconf"></a> /etc/wsl.conf</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用systemd</span></span><br><span class="line">[boot]</span><br><span class="line">systemd=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 設定預設的使用者</span></span><br><span class="line">[<span class="built_in">users</span>]</span><br><span class="line">default=&lt;username&gt;</span><br></pre></td></tr></table></figure><h2 id="yay"><a class="markdownIt-Anchor" href="#yay"></a> yay</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 需要先安裝上go, git, base-devel</span></span><br><span class="line"><span class="built_in">cd</span> &lt;what ever you like&gt;</span><br><span class="line">git <span class="built_in">clone</span> https://aur.archlinux.org/yay.git</span><br><span class="line"><span class="built_in">cd</span> yay</span><br><span class="line">makepkg -si</span><br></pre></td></tr></table></figure><p>yay為目前安裝<code>AUR</code>最方便的工具所以強烈建議裝上</p><h2 id="zsh-manjaro-zsh-config-optional"><a class="markdownIt-Anchor" href="#zsh-manjaro-zsh-config-optional"></a> zsh &amp; manjaro-zsh-config (Optional)</h2><p>請參考<a href="https://kiwi0093.github.io/wiki/wiki/Misc/Zsh/1-Zsh&amp;Powerlevel10k/">其他篇wiki進行設定</a></p><h2 id="tmux-oh-my-tmux-optional"><a class="markdownIt-Anchor" href="#tmux-oh-my-tmux-optional"></a> Tmux + oh-my-tmux (Optional)</h2><p>請參考<a href="https://kiwi0093.github.io/wiki/wiki/Misc/Tmux/1-Tmux+oh-my-tmux/">其他篇wiki進行設定</a></p><h2 id="neovim-nvchad-optional"><a class="markdownIt-Anchor" href="#neovim-nvchad-optional"></a> NeoVim + NvChad (Optional)</h2><p>這個在<a href="https://kiwi0093.github.io/wiki/wiki/Misc/Vim/NeoVim%20+%20NvChad/1-Basic%20Install%20&amp;%20Configure/">其他篇wiki內有寫請參考</a></p><h2 id="npm-npm-check-update-etcoptional"><a class="markdownIt-Anchor" href="#npm-npm-check-update-etcoptional"></a> npm + npm-check-update …etc(Optional)</h2><p>這個是我個人喜歡用這個來管理我在Github上的Blog &amp; Wiki所需<br />請參考<a href="https://kiwi0093.github.io/wiki/wiki/Network/Hexo/3-Hexo-setting/">其他的wiki內容</a></p><h1 id="guiwslg"><a class="markdownIt-Anchor" href="#guiwslg"></a> GUI(WSLg)</h1><h2 id="x-server"><a class="markdownIt-Anchor" href="#x-server"></a> X server</h2><p>參考資料：</p><ul><li><a href="https://github.com/microsoft/wslg/issues/782">Bug of WSL Preview - Empty /mnt/wslg/.X11-unix &amp; /tmp/.X11-unix Directory</a></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 檢查Display為:0</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$DISPLAY</span></span><br><span class="line">:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 檢查/mnt/wslg/.X11-unix存在，以及是否為 /tmp/.X11-unix -&gt; /mnt/wslg/.X11-unix</span></span><br><span class="line"><span class="built_in">ls</span> -la /mnt/wslg</span><br><span class="line"><span class="built_in">ls</span> -la /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment">#若/mnt/wslg/.X11-unix存在但沒有link到/tmp/.X11-unix</span></span><br><span class="line">sudo <span class="built_in">rm</span> -r /tmp/.X11-unix</span><br><span class="line"><span class="built_in">ln</span> -s /mnt/wslg/.X11-unix /tmp/.X11-unix</span><br></pre></td></tr></table></figure><p>然後測試你的GUI軟體是否可以正確的執行若可以執行下一步，若不行…請翻文件…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/etc/tmpfiles.d/wslg.conf</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment"># TYPE    PATH        Mode    UID    GID Age    Argument</span></span><br><span class="line">L+    /tmp/.X11-unix    -        -    -    -    /mnt/wslg/.X11unix</span><br></pre></td></tr></table></figure><p>@powershell &gt; wsl --shutdown<br />然後重新進入WSL就可以了</p><h2 id="dolphin-breeze-optional"><a class="markdownIt-Anchor" href="#dolphin-breeze-optional"></a> dolphin + breeze (Optional)</h2><p>Dolphin是KDE的文件管理器(類似windows的explore)<br />只裝dolphin會有缺icon的問題發生所以要裝上KDE的theme - breeze才會正常</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S breeze dolphin</span><br></pre></td></tr></table></figure><h2 id="remmina-freerdp-optional"><a class="markdownIt-Anchor" href="#remmina-freerdp-optional"></a> Remmina + freerdp (Optional)</h2><p>這個是個很好用的rdp client，不過remmina只是個皮，要裝上freerdp才能RDP到其他RDP server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S remmina freerdp</span><br></pre></td></tr></table></figure><h2 id="brave-optional"><a class="markdownIt-Anchor" href="#brave-optional"></a> Brave (Optional)</h2><p>總要有瀏覽器…不然GUI要幹麻</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S brave-bin</span><br></pre></td></tr></table></figure><h2 id="fcitx-optional"><a class="markdownIt-Anchor" href="#fcitx-optional"></a> Fcitx (Optional)</h2><p>基本上因為我們不會在WSL內安裝完整的桌面環境所以在挑選Fcitx的時候只能用Fcitx4的版本所以不要假會去裝Fcitx5…<br />詳細的內容我放在<a href="https://kiwi0093.github.io/wiki/wiki/Linux/Tips/6-Fcitx/">其他的wiki內，請參考</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;現在&lt;code&gt;WSLg&lt;/code&gt;基本上已經內建在WSL安裝內，所以不再需要弄個&lt;code&gt;GWSL&lt;/code&gt;來進行設定&lt;br /&gt;
順便紀錄一下&lt;code&gt;ArchWSL&lt;/code&gt;的一些設定以免忘記&lt;/p&gt;</summary>
    
    
    
    <category term="Linux" scheme="http://kiwi0093.github.io/wiki/categories/Linux/"/>
    
    <category term="WSL" scheme="http://kiwi0093.github.io/wiki/categories/Linux/WSL/"/>
    
    
    <category term="Linunx" scheme="http://kiwi0093.github.io/wiki/tags/Linunx/"/>
    
    <category term="Windows" scheme="http://kiwi0093.github.io/wiki/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>Traefik</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/2-traefik/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/2-traefik/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>雖然之前有講過可以用Nginx Proxy Manager來進行內外網路的轉址不過那些還要真的Mapping出來才能用,使用Traefik的話就不需要這麼麻煩了</p><span id="more"></span><h1 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念"></a> 基本概念</h1><p>其實就是一堆virtual host只是它不用去寫一堆設定檔,可以在docker-compose.yml內用label定義後直接就可以用了</p><h1 id="traek本體"><a class="markdownIt-Anchor" href="#traek本體"></a> Traek本體</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Docker-compose.yml</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">traefik:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;traefik:v2.5&quot;</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">&quot;traefik&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="comment">#### Traefik CLI commands to configure Traefik! ####</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--api.insecure=false</span> <span class="comment"># &lt;== DisEnabling insecure api. Default is ture.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--api.dashboard=true</span> <span class="comment"># &lt;== Enabling the dashboard to view services, middlewares, routers, etc...</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--api.debug=true</span> <span class="comment"># &lt;== Enabling additional endpoints for debugging and profiling</span></span><br><span class="line">      <span class="comment">## Provider Settings - https://docs.traefik.io/providers/docker/#provider-configuration ##</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--providers.docker=true</span> <span class="comment"># &lt;== Enabling docker as the provider for traefik</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--providers.docker.exposedbydefault=false</span> <span class="comment"># &lt;== Don&#x27;t expose every container to traefik, only expose enabled ones</span></span><br><span class="line">      <span class="comment">## Entrypoints Settings - https://docs.traefik.io/routing/entrypoints/#configuration ##</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--entrypoints.web.address=:80</span> <span class="comment"># &lt;== Defining an entrypoint for port :80 named web</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--entrypoints.web-secured.address=:443</span> <span class="comment"># &lt;== Defining an entrypoint for https on port :443 named web-secured</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--certificatesresolvers.myresolver.acme.httpchallenge=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--certificatesresolvers.myresolver.acme.tlschallenge=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--certificatesresolvers.myresolver.acme.email=kiwi@kaienroid.com&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--certificatesresolvers.myresolver.acme.storage=/letsencrypt/acme.json&quot;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">443</span><span class="string">:443</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/lib/docker/volumes/traefik/letsencrypt:/letsencrypt</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock:ro</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="comment">#### Labels define the behavior and rules of the traefik proxy for this container ####</span></span><br><span class="line">      <span class="attr">traefik.enable:</span> <span class="literal">true</span> <span class="comment"># &lt;== Enable traefik on itself to view dashboard and assign subdomain to view it</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#redirecting ALL HTTP to HTTPS</span></span><br><span class="line">      <span class="attr">traefik.http.routers.http_catchall.rule:</span> <span class="string">hostregexp(`&#123;host:.*&#125;`)</span></span><br><span class="line">      <span class="attr">traefik.http.routers.http_catchall.entryPoints:</span> <span class="string">web</span></span><br><span class="line">      <span class="attr">traefik.http.routers.http_catchall.middlewares:</span> <span class="string">redirect_https</span> <span class="comment"># &lt;== apply redirect_https middleware which is defined in the below</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#dashboard</span></span><br><span class="line">      <span class="attr">traefik.http.routers.traefik.rule:</span> <span class="string">Host(`traefik.example.com`)</span> <span class="comment"># &lt;== Setting the domain for the dashboard</span></span><br><span class="line">      <span class="attr">traefik.http.routers.traefik.entryPoints:</span> <span class="string">web-secured</span></span><br><span class="line">      <span class="attr">traefik.http.routers.traefik.tls:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">traefik.http.routers.traefik.tls.certresolver:</span> <span class="string">myresolver</span></span><br><span class="line">      <span class="attr">traefik.http.routers.traefik.service:</span> <span class="string">api@internal</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#to define middlewares</span></span><br><span class="line">      <span class="attr">traefik.http.middlewares.redirect_https.redirectscheme.scheme:</span> <span class="string">https</span> <span class="comment"># &lt;== define a https redirection middleware</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">backend:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure><p>其實是可以把command裡的指令改用traefik.toml載入也可以,簡單說明如下(雖然裡面的說明很多了)</p><ul><li>Docker Network 這個其實沒差,只是一般來說有多到需要Traefik的Server一般來說還是會整理一下Docker Network才不會那麼亂</li><li>Command 這個指令其實是讓docker container啟動後自動執行的指令裡可以從上面看得出來幾乎都是定義環境的</li><li>Volumes 這裡特別說明一下為什麼SSL要另外找地方放,因為Traefik是用ACME.Json的形式來存所有的SSL Key,另外一個要對應docker.sock很常見就是要知道你哪些container在跑</li><li>labels 這個就是traefik的精華部份了,traefik就是利用labels定義讓他自動產生virtual host這樣container一打開就會自動弄好非常方便連NPM的操作都免了</li></ul><h1 id="對應app的設定方式"><a class="markdownIt-Anchor" href="#對應app的設定方式"></a> 對應App的設定方式</h1><h2 id="docker-composeyml相關設定"><a class="markdownIt-Anchor" href="#docker-composeyml相關設定"></a> docker-compose.yml相關設定</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不需要定義Port Mapping</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 須讓該app加入Traefik的網路中所以要在docker-compose.yml內加上</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">default:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">my-pre-existing-network</span></span><br></pre></td></tr></table></figure><h2 id="labels範例"><a class="markdownIt-Anchor" href="#labels範例"></a> Labels範例</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># V2ray traefik labels</span></span><br><span class="line"><span class="attr">labels:</span></span><br><span class="line">      <span class="attr">traefik.enable:</span> <span class="literal">true</span> <span class="comment"># 表示這個container需要啟動Traefik</span></span><br><span class="line">      <span class="attr">traefik.http.routers.v2ray.rule:</span> <span class="string">Host(`v2ray.example.com`)</span> <span class="comment"># 定義對應的virtual Host</span></span><br><span class="line">      <span class="attr">traefik.http.routers.v2ray.tls:</span> <span class="literal">true</span> <span class="comment"># 使用tls確認用https</span></span><br><span class="line">      <span class="attr">traefik.http.routers.v2ray.tls.certresolver:</span> <span class="string">myresolver</span> <span class="comment"># SSL證書的簽發單位,要對應traefik本體Command定義的</span></span><br></pre></td></tr></table></figure><p>可以看得出來基本的邏輯是</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">traefik.&lt;主要服務,http/tcp/udp&gt;.&lt;子項,routers/services/middlewares&gt;.&lt;App</span> <span class="string">Name&gt;.&lt;label</span> <span class="string">item&gt;:</span> <span class="string">&lt;define&gt;</span></span><br></pre></td></tr></table></figure><h1 id="注意事項"><a class="markdownIt-Anchor" href="#注意事項"></a> 注意事項</h1><p>在Traefik後的服務請不要跑SSL,把前端的部份都交給Traefik就好了</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;雖然之前有講過可以用Nginx Proxy Manager來進行內外網路的轉址不過那些還要真的Mapping出來才能用,使用Traefik的話就不需要這麼麻煩了&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="Service Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/"/>
    
    <category term="Common" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/Common/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>ZSH / Powerlevel10k</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Misc/Zsh/1-Zsh&amp;Powerlevel10k/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Misc/Zsh/1-Zsh&amp;Powerlevel10k/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-22T08:49:19.921Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>自從用過Manjaro KDE後被他的zsh console風格吸引,接著就繼續無性繁殖同樣的設定</p><span id="more"></span><h1 id="zsh安裝"><a class="markdownIt-Anchor" href="#zsh安裝"></a> ZSH安裝</h1><p>這個很簡單,基本上依靠系統的package manager安裝就好了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Archlinux系</span></span><br><span class="line">sudo pacman -S zsh</span><br><span class="line">或</span><br><span class="line">yay -S zsh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum系</span></span><br><span class="line">yum install zsh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">FreeBSD</span></span><br><span class="line">pkg install zsh</span><br></pre></td></tr></table></figure><h1 id="manjaro-zsh-config-archlinux"><a class="markdownIt-Anchor" href="#manjaro-zsh-config-archlinux"></a> Manjaro-zsh-config @ Archlinux</h1><p>因為manjaro-zsh-config在AUR內,只要安裝這個package就會自動把相關的都裝上所以問題不大</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Archlinux系</span><br><span class="line"># 這個在AUR內所以</span><br><span class="line">git clone https://aur.archlinux.org/manjaro-zsh-config.git</span><br><span class="line">cd manjaro-zsh-config &amp;&amp; makepkg -si</span><br><span class="line">或是更簡單的</span><br><span class="line">yay -S manjaro-zsh-config</span><br></pre></td></tr></table></figure><p>記得要把<code>/etc/zsh/zshrc-manjaro/.zshrc</code>複製到<code>~/.zshrc</code>這樣才會生效</p><h1 id="其他作業系統"><a class="markdownIt-Anchor" href="#其他作業系統"></a> 其他作業系統</h1><h2 id="packages-for-manjaro-zsh-config"><a class="markdownIt-Anchor" href="#packages-for-manjaro-zsh-config"></a> packages for manjaro-zsh-config</h2><ul><li><p>zsh-completions</p></li><li><p>zsh-autosuggestions</p></li><li><p>zsh-history-substring-search</p></li><li><p>zsh-syntax-highlighting</p></li><li><p>zsh-theme-powerlevel10k</p></li><li><p>ttf-noto-nerd (Noto Nerd Fonts)</p></li></ul><h3 id="zsh-theme-powerlevel10k安裝"><a class="markdownIt-Anchor" href="#zsh-theme-powerlevel10k安裝"></a> zsh-theme-powerlevel10k安裝</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Archlinux系</span></span><br><span class="line">sudo pacman -S zsh-theme-powerlevel10k</span><br><span class="line">or</span><br><span class="line">yay -S zsh-theme-powerlevel10k</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">其他系統 - Manual Installation</span></span><br><span class="line">sudo git clone --depth=1 https://github.com/romkatv/powerlevel10k.git /usr/share/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">因為後面要搭配manjaro的設定檔,所以安裝位置固定</span></span><br></pre></td></tr></table></figure><h3 id="gitstatus安裝"><a class="markdownIt-Anchor" href="#gitstatus安裝"></a> gitstatus安裝</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git clone --depth=1 https://github.com/romkatv/gitstatus.git /usr/share/zsh-theme-powerlevel10k/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">因為後面要搭配manjaro的設定檔,所以安裝位置固定</span></span><br></pre></td></tr></table></figure><h3 id="manjaro-zsh-config的設定檔"><a class="markdownIt-Anchor" href="#manjaro-zsh-config的設定檔"></a> Manjaro-zsh-config的設定檔</h3><p>因為沒有可直接安裝的package,所以請用以下的script跑</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Chrysostomus/manjaro-zsh-config</span><br><span class="line">sudo cp -Rv manjaro-zsh-config/manjaro-zsh-prompt /usr/share/zsh/</span><br><span class="line">sudo cp -Rv manjaro-zsh-config/zsh-maia-prompt /usr/share/zsh/</span><br><span class="line">sudo cp -Rv manjaro-zsh-config/p10k.zsh /usr/share/zsh/</span><br><span class="line">sudo cp -Rv manjaro-zsh-config/p10k-portable.zsh /usr/share/zsh/</span><br><span class="line">sudo cp -Rv manjaro-zsh-config/command-not-found.zsh /usr/share/zsh/functions/</span><br><span class="line">sudo cp -Rv manjaro-zsh-config/.zshrc /etc/zsh/zshrc-manjaro</span><br><span class="line">sudo cp -r manjaro-zsh-config/base16-shell /usr/share/zsh/scripts/</span><br><span class="line">sudo chmod a+x /usr/share/zsh/scripts/base16-shell/</span><br></pre></td></tr></table></figure><p>然後把<code>.zshrc</code>放到<code>~/</code>執行zsh就好了</p><h1 id="windows-terminal-nerd-fonts-dsiplay"><a class="markdownIt-Anchor" href="#windows-terminal-nerd-fonts-dsiplay"></a> Windows Terminal Nerd Fonts Dsiplay</h1><h2 id="安裝nerd-fonts"><a class="markdownIt-Anchor" href="#安裝nerd-fonts"></a> 安裝Nerd Fonts</h2><p>但是因為是<code>WSL</code>所以除了裡面的系統要安裝noto-nerd-font以外,外面的Windows也是要安裝nerd font<br />不然不能正確顯示</p><p><a href="https://nerdfonts.com">Nerd Fonts</a>收集各種Nerd font的網頁<br /><a href="https://www.nerdfonts.com"><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/nerd_font.png" alt="Nerd Fonts" /></a></p><p>到<code>Download</code>內挑自己喜歡的版本下載</p><p>我個人喜歡用<a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/Noto.zip">noto-nerd-font</a><br /><a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/Noto.zip"><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/noto-nerd-fonts.png" alt="Noto Nerd Font" /></a></p><p>下載後請記得解開Zip檔後安裝字型</p><h2 id="設定windows-terminal字型"><a class="markdownIt-Anchor" href="#設定windows-terminal字型"></a> 設定Windows Terminal字型</h2><p><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/windows_terminal_archwsl_setting1.png" alt="Windows Terminal Setting 1" /></p><p>在設定內選擇你的ArchWSL選項然後選擇外觀</p><p><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/windows_terminal_archwsl_setting2.png" alt="Windows Terminal Setting 2" /></p><p>將字型改成你下載的<code>Nerd Font</code>然後記得保存你的變更後就好了</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;自從用過Manjaro KDE後被他的zsh console風格吸引,接著就繼續無性繁殖同樣的設定&lt;/p&gt;</summary>
    
    
    
    <category term="Misc" scheme="http://kiwi0093.github.io/wiki/categories/Misc/"/>
    
    <category term="Zsh" scheme="http://kiwi0093.github.io/wiki/categories/Misc/Zsh/"/>
    
    
    <category term="FreeBSD" scheme="http://kiwi0093.github.io/wiki/tags/FreeBSD/"/>
    
    <category term="Linux" scheme="http://kiwi0093.github.io/wiki/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Hexo介紹與整體規劃</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Hexo/1.introduce/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Hexo/1.introduce/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="目標"><a class="markdownIt-Anchor" href="#目標"></a> 目標</h2><p>利用<a href="https://hexo.io/zh-tw/">Hexo</a> + <a href="https://pages.github.com/">Github Page</a>實現個人Blog + Wiki的搭建</p><span id="more"></span><h2 id="基本架構"><a class="markdownIt-Anchor" href="#基本架構"></a> 基本架構</h2><p><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/Blog_wiki_construction.PNG" alt="Construction" /></p><h3 id="說明"><a class="markdownIt-Anchor" href="#說明"></a> 說明</h3><p>這裡利用了Github Page的幾個特性</p><ul><li>在<Username>.github.io這個repo的master內的index.html會產生https://<Username>.github.io/這個有效網址</li><li>在其他repo中,Github Page會把branch:gh-pages內的index.thml產生出https://<username>.github.io/&lt;其他repo&gt;/這個有效網址</li></ul><p>所以可以將Blog的網頁產生到<username>.github.io這個repo的master裡面作為主網頁,將其他想要的theme的網頁產生到其他repo的gh-pages內作為其他子網站使用</p><p>雖然可以利用Hexo指令可以跑特定<code>_config.yml</code>的方法可以把兩個放在一起,但是其實原理上跟上表是一樣的只是可以把Hexo Wiki 跟Hexo Blog存在同一個目錄裡面將git同步管理這點整合</p><h3 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h3><p><a href="https://hexo.io/zh-tw/docs/">Hexo官方文件</a></p><p><a href="https://ohlia.github.io/Wiki-site/">OHLIA’s Wiki</a></p><p><a href="https://masantu.com/blog/2020-05-23/hello-hexo-wiki/#%E6%9B%B4%E6%96%B0">別院牧志</a></p><p><a href="https://kuang.netlify.app/blog/hexo.html">風月</a></p><p><a href="https://ryanluoxu.github.io/2017/11/27/Hexo-Next-%E6%B7%BB%E5%8A%A0-Gitment-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/">途探生靈</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;目標&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#目標&quot;&gt;&lt;/a&gt; 目標&lt;/h2&gt;
&lt;p&gt;利用&lt;a href=&quot;https://hexo.io/zh-tw/&quot;&gt;Hexo&lt;/a&gt; + &lt;a href=&quot;https://pages.github.com/&quot;&gt;Github Page&lt;/a&gt;實現個人Blog + Wiki的搭建&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Hexo" scheme="http://kiwi0093.github.io/wiki/categories/Network/Hexo/"/>
    
    
    <category term="Git" scheme="http://kiwi0093.github.io/wiki/tags/Git/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="Server" scheme="http://kiwi0093.github.io/wiki/tags/Server/"/>
    
    <category term="Blog" scheme="http://kiwi0093.github.io/wiki/tags/Blog/"/>
    
    <category term="Wiki" scheme="http://kiwi0093.github.io/wiki/tags/Wiki/"/>
    
  </entry>
  
  <entry>
    <title>Hexo安裝</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Hexo/2-installation/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Hexo/2-installation/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>Hexo是個很簡單好用的靜態網頁產生工具,基本上就是需要npm+node.js</p><span id="more"></span><h2 id="相關工具"><a class="markdownIt-Anchor" href="#相關工具"></a> 相關工具</h2><h3 id="git"><a class="markdownIt-Anchor" href="#git"></a> Git</h3><ul><li><h4 id="linux"><a class="markdownIt-Anchor" href="#linux"></a> Linux</h4><ul><li><h5 id="arch系列"><a class="markdownIt-Anchor" href="#arch系列"></a> Arch系列</h5></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S git</span><br></pre></td></tr></table></figure><ul><li><h5 id="debianubuntu系"><a class="markdownIt-Anchor" href="#debianubuntu系"></a> Debian/Ubuntu系</h5></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git-core</span><br></pre></td></tr></table></figure><p>由於Github Desktop Linux版的安裝比較麻煩,尤其是在<s>強國</s>天朝內沒有翻牆的情況下安裝比較累</p><p>所以會建議用Command Line的git就好了,大不了寫成script還是很方便</p></li><li><h4 id="windows"><a class="markdownIt-Anchor" href="#windows"></a> Windows</h4><p>Windows下建議直接下載<a href="https://desktop.github.com/">Github Desktop</a>會比較方便,可以在官方網頁上下載安裝也可以透過chocolatey安裝</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install github-desktop</span><br></pre></td></tr></table></figure></li></ul><h3 id="nodejs-npm"><a class="markdownIt-Anchor" href="#nodejs-npm"></a> node.js &amp; npm</h3><ul><li><h4 id="linux-2"><a class="markdownIt-Anchor" href="#linux-2"></a> Linux</h4><ul><li><h5 id="arch系列-2"><a class="markdownIt-Anchor" href="#arch系列-2"></a> Arch系列</h5></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S nodejs npm</span><br></pre></td></tr></table></figure><ul><li><h5 id="debianubuntu系-2"><a class="markdownIt-Anchor" href="#debianubuntu系-2"></a> Debian/Ubuntu系</h5></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y nodejs npm </span><br></pre></td></tr></table></figure></li><li><h4 id="windows-2"><a class="markdownIt-Anchor" href="#windows-2"></a> Windows</h4><p>同Github Desktop,可以去<a href="https://nodejs.org/en/">node.js</a>下載安裝,裝的時候就會包含npm一起裝了,或是透過chocolatey安裝</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install nodejs</span><br></pre></td></tr></table></figure></li></ul><h2 id="hexo安裝"><a class="markdownIt-Anchor" href="#hexo安裝"></a> Hexo安裝</h2><p>Hexo是利用npm安裝的,我沒在WIndows下安裝過,但是我想應該都是一樣的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>跑完就裝好了</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;Hexo是個很簡單好用的靜態網頁產生工具,基本上就是需要npm+node.js&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Hexo" scheme="http://kiwi0093.github.io/wiki/categories/Network/Hexo/"/>
    
    
    <category term="Git" scheme="http://kiwi0093.github.io/wiki/tags/Git/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="Server" scheme="http://kiwi0093.github.io/wiki/tags/Server/"/>
    
    <category term="Blog" scheme="http://kiwi0093.github.io/wiki/tags/Blog/"/>
    
    <category term="Wiki" scheme="http://kiwi0093.github.io/wiki/tags/Wiki/"/>
    
  </entry>
  
  <entry>
    <title>Hexo的Plugin與使用</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Hexo/4-Hexo-plugin/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Hexo/4-Hexo-plugin/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="plugin安裝方法"><a class="markdownIt-Anchor" href="#plugin安裝方法"></a> Plugin安裝方法</h2><p>Hexo Plugin官方網頁:<a href="https://hexo.io/plugins/">https://hexo.io/plugins/</a></p><span id="more"></span><h3 id="基本命令"><a class="markdownIt-Anchor" href="#基本命令"></a> 基本命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安裝</span></span><br><span class="line">npm install &lt;plugin&gt; --save</span><br><span class="line"><span class="comment">#解除安裝</span></span><br><span class="line">npm uninstall &lt;plugin&gt; --save</span><br><span class="line"><span class="comment">#更新plugin &amp; Framework(under Hexo Dir)</span></span><br><span class="line">npm update</span><br></pre></td></tr></table></figure><h3 id="追加指令"><a class="markdownIt-Anchor" href="#追加指令"></a> 追加指令</h3><p>先安裝npm-check-update</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Manjaro環境</span></span><br><span class="line">pacman -S npm-check-update</span><br></pre></td></tr></table></figure><p>有用的指令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#確認哪些package過期了</span></span><br><span class="line">npm outdate</span><br><span class="line"></span><br><span class="line"><span class="comment">#確認是否有最新的package</span></span><br><span class="line">npm-check-update</span><br><span class="line"><span class="comment">#update package.json</span></span><br><span class="line">ncu -u</span><br><span class="line"><span class="comment">#更新package</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>另外,當git clone下整個Blog(包含package.json)時可以不用重新下安裝指令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#依照package.json更新整個node_module</span></span><br><span class="line">npm update</span><br></pre></td></tr></table></figure><h2 id="本站有安裝的plugin"><a class="markdownIt-Anchor" href="#本站有安裝的plugin"></a> 本站有安裝的Plugin</h2><ul><li><p><a href="https://github.com/hexojs/hexo-deployer-git">hexo-deployer-git</a></p></li><li><p><a href="https://github.com/CHENXCHEN/hexo-renderer-markdown-it-plus">hexo-renderer-markdown-it-plus</a></p></li><li><p><a href="https://github.com/hexojs/hexo-html-minifier">hexo-html-minifier</a></p></li></ul><h2 id="相關設定"><a class="markdownIt-Anchor" href="#相關設定"></a> 相關設定</h2><h4 id="render-markdown-it-plus-section"><a class="markdownIt-Anchor" href="#render-markdown-it-plus-section"></a> Render-markdown-it-plus Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">markdown_it_plus:</span><br><span class="line">    highlight: <span class="literal">true</span></span><br><span class="line">    html: <span class="literal">true</span></span><br><span class="line">    xhtmlOut: <span class="literal">true</span></span><br><span class="line">    breaks: <span class="literal">true</span></span><br><span class="line">    langPrefix:</span><br><span class="line">    linkify: <span class="literal">true</span></span><br><span class="line">    typographer:</span><br><span class="line">    quotes: “”‘’</span><br><span class="line">    pre_class: highlight</span><br></pre></td></tr></table></figure><h4 id="deployment-section"><a class="markdownIt-Anchor" href="#deployment-section"></a> Deployment Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:<span class="comment">//github.com/&lt;Username&gt;/&lt;username&gt;.github.io</span></span><br><span class="line">  branch: &lt;branch_name&gt;</span><br></pre></td></tr></table></figure><h4 id="hexo-html-minifier"><a class="markdownIt-Anchor" href="#hexo-html-minifier"></a> Hexo-html-minifier</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">html_minifier:  </span><br><span class="line">  collapseBooleanAttributes: <span class="literal">true</span></span><br><span class="line">  collapseWhitespace: <span class="literal">true</span></span><br><span class="line">  # Ignore <span class="string">&#x27;&lt;!-- more --&gt;&#x27;</span> https:<span class="comment">//hexo.io/docs/tag-plugins#Post-Excerpt</span></span><br><span class="line">  ignoreCustomComments: [ !!js/regexp /^\s*more/]</span><br><span class="line">  removeComments: <span class="literal">true</span></span><br><span class="line">  removeEmptyAttributes: <span class="literal">true</span></span><br><span class="line">  removeScriptTypeAttributes: <span class="literal">true</span></span><br><span class="line">  removeStyleLinkTypeAttributes: <span class="literal">true</span></span><br><span class="line">  minifyJS: <span class="literal">true</span></span><br><span class="line">  minifyCSS: <span class="literal">true</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;plugin安裝方法&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#plugin安裝方法&quot;&gt;&lt;/a&gt; Plugin安裝方法&lt;/h2&gt;
&lt;p&gt;Hexo Plugin官方網頁:&lt;a href=&quot;https://hexo.io/plugins/&quot;&gt;https://hexo.io/plugins/&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Hexo" scheme="http://kiwi0093.github.io/wiki/categories/Network/Hexo/"/>
    
    
    <category term="Git" scheme="http://kiwi0093.github.io/wiki/tags/Git/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="Server" scheme="http://kiwi0093.github.io/wiki/tags/Server/"/>
    
    <category term="Blog" scheme="http://kiwi0093.github.io/wiki/tags/Blog/"/>
    
    <category term="Wiki" scheme="http://kiwi0093.github.io/wiki/tags/Wiki/"/>
    
  </entry>
  
  <entry>
    <title>Hexo基本設定與使用</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Hexo/3-Hexo-setting/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Hexo/3-Hexo-setting/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hexo本體設定"><a class="markdownIt-Anchor" href="#hexo本體設定"></a> Hexo本體設定</h2><p>Hexo本體的設定均在<code>&lt;folder&gt;/_config.yml</code>裡面,大多數的設定都可以直接沿用很方便只有一些部分需要修改調整</p><p>詳細的<a href="https://hexo.io/docs/configuration.html">Hexo Configuration</a></p><span id="more"></span><h4 id="site-section"><a class="markdownIt-Anchor" href="#site-section"></a> #Site Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: Kiwi<span class="number">&#x27;</span>s Blog</span><br><span class="line">subtitle: 中年大叔的自言自語</span><br><span class="line">description: <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">keywords:</span></span><br><span class="line"><span class="string">author: Kiwi </span></span><br><span class="line"><span class="string">language: zh_TW</span></span><br><span class="line"><span class="string">timezone: </span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>title</code></td><td style="text-align:left">網站標題</td></tr><tr><td style="text-align:left"><code>subtitle</code></td><td style="text-align:left">網站副標題</td></tr><tr><td style="text-align:left"><code>description</code></td><td style="text-align:left">網站描述</td></tr><tr><td style="text-align:left"><code>keywords</code></td><td style="text-align:left">網站的關鍵詞。支援多個關鍵詞。</td></tr><tr><td style="text-align:left"><code>author</code></td><td style="text-align:left">您的名字</td></tr><tr><td style="text-align:left"><code>language</code></td><td style="text-align:left">網站使用的語言，參考 <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">2-lettter ISO-639-1 code</a>，預設為 <code>en</code></td></tr><tr><td style="text-align:left"><code>timezone</code></td><td style="text-align:left">網站時區，Hexo 預設使用您電腦的時區，您可以在 <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">時區列表</a> 尋找適當的時區，例如 <code>America/New_York</code> 、 <code>Japan</code> 與 <code>UTC</code></td></tr></tbody></table><h4 id="url-section"><a class="markdownIt-Anchor" href="#url-section"></a> #URL Section</h4><p>如果您的網站存放在子目錄中，例如 <code>http://example.org/blog</code>，請將您的 <code>url</code> 設為 <code>http://example.org/blog</code> 並把 <code>root</code> 設為 <code>/blog/</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># URL</span><br><span class="line">url: https://kiwi0093.github.io/</span><br><span class="line">root: /</span><br><span class="line">permalink: :year/:month/:day/:title/</span><br><span class="line">permalink_defaults:</span><br><span class="line">pretty_urls:</span><br><span class="line">  trailing_index: true</span><br><span class="line">  trailing_html: true</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th><th style="text-align:left">預設值</th></tr></thead><tbody><tr><td style="text-align:left"><code>url</code></td><td style="text-align:left">網站的網址，must starts with <code>http://</code> or <code>https://</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>root</code></td><td style="text-align:left">網站的根目錄</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>permalink</code></td><td style="text-align:left">文章 <a href="https://hexo.io/zh-tw/docs/permalinks">永久連結</a> 的格式</td><td style="text-align:left"><code>:year/:month/:day/:title/</code></td></tr><tr><td style="text-align:left"><code>permalink_defaults</code></td><td style="text-align:left"><code>permalink</code> 中各區段的預設值</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>pretty_urls</code></td><td style="text-align:left">改寫 <a href="https://hexo.io/zh-tw/docs/variables"><code>permalink</code></a> 的值來美化 URL</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>pretty_urls.trailing_index</code></td><td style="text-align:left">是否在永久鏈接中保留尾部的 <code>index.html</code>，設置為 <code>false</code> 時去除</td><td style="text-align:left"><code>true</code></td></tr><tr><td style="text-align:left"><code>pretty_urls.trailing_html</code></td><td style="text-align:left">是否在永久鏈接中保留尾部的 <code>.html</code>, 設置為 <code>false</code> 時去除 (<em>對尾部的 <code>index.html</code>無效</em>)</td><td style="text-align:left"><code>true</code></td></tr></tbody></table><h4 id="directory-section"><a class="markdownIt-Anchor" href="#directory-section"></a> #Directory Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Directory</span><br><span class="line">source_dir: source</span><br><span class="line">public_dir: public</span><br><span class="line">tag_dir: tags</span><br><span class="line">archive_dir: archives</span><br><span class="line">category_dir: categories</span><br><span class="line">code_dir: downloads/code</span><br><span class="line">i18n_dir: :lang</span><br><span class="line">skip_render:</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th><th style="text-align:left">預設值</th></tr></thead><tbody><tr><td style="text-align:left"><code>source_dir</code></td><td style="text-align:left">原始檔案資料夾，這個資料夾用於存放您的內容</td><td style="text-align:left"><code>source</code></td></tr><tr><td style="text-align:left"><code>public_dir</code></td><td style="text-align:left">靜態檔案資料夾，這個資料夾用於存放建立完畢的檔案</td><td style="text-align:left">public</td></tr><tr><td style="text-align:left"><code>tag_dir</code></td><td style="text-align:left">標籤資料夾</td><td style="text-align:left"><code>tags</code></td></tr><tr><td style="text-align:left"><code>archive_dir</code></td><td style="text-align:left">彙整資料夾</td><td style="text-align:left"><code>archives</code></td></tr><tr><td style="text-align:left"><code>category_dir</code></td><td style="text-align:left">分類資料夾</td><td style="text-align:left"><code>categories</code></td></tr><tr><td style="text-align:left"><code>code_dir</code></td><td style="text-align:left">Include code 資料夾</td><td style="text-align:left"><code>downloads/code</code></td></tr><tr><td style="text-align:left"><code>i18n_dir</code></td><td style="text-align:left">國際化（i18n）資料夾</td><td style="text-align:left"><code>:lang</code></td></tr><tr><td style="text-align:left"><code>skip_render</code></td><td style="text-align:left">跳過指定檔案的渲染，您可使用 <a href="https://github.com/micromatch/micromatch#extended-globbing">glob 表達式</a> 來配對路徑</td><td style="text-align:left"></td></tr></tbody></table><h4 id="writing-section"><a class="markdownIt-Anchor" href="#writing-section"></a> # Writing Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># Writing</span><br><span class="line">new_post_name: :title.md</span><br><span class="line">default_layout: post</span><br><span class="line">titlecase: <span class="literal">false</span></span><br><span class="line">external_link:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  field: site</span><br><span class="line">  exclude: <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">filename_case: 0</span></span><br><span class="line"><span class="string">render_drafts: false</span></span><br><span class="line"><span class="string">post_asset_folder: false</span></span><br><span class="line"><span class="string">relative_link: false</span></span><br><span class="line"><span class="string">future: true</span></span><br><span class="line"><span class="string">highlight:</span></span><br><span class="line"><span class="string">  enable: true</span></span><br><span class="line"><span class="string">  line_number: true</span></span><br><span class="line"><span class="string">  auto_detect: false</span></span><br><span class="line"><span class="string">  tab_replace: &#x27;</span>&#x27;</span><br><span class="line">  wrap: <span class="literal">true</span></span><br><span class="line">  hljs: <span class="literal">false</span></span><br><span class="line">prismjs:</span><br><span class="line">  enable: <span class="literal">false</span></span><br><span class="line">  preprocess: <span class="literal">true</span></span><br><span class="line">  line_number: <span class="literal">true</span></span><br><span class="line">  tab_replace: <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th><th style="text-align:left">預設值</th></tr></thead><tbody><tr><td style="text-align:left"><code>new_post_name</code></td><td style="text-align:left">新文章的檔案名稱</td><td style="text-align:left"><code>:title.md</code></td></tr><tr><td style="text-align:left"><code>default_layout</code></td><td style="text-align:left">預設佈局</td><td style="text-align:left"><code>post</code></td></tr><tr><td style="text-align:left"><code>auto_spacing</code></td><td style="text-align:left">在西方文字與東方文字中加入空白</td><td style="text-align:left"><code>false</code></td></tr><tr><td style="text-align:left"><code>titlecase</code></td><td style="text-align:left">把標題轉換為 title case</td><td style="text-align:left"><code>false</code></td></tr><tr><td style="text-align:left"><code>external_link</code></td><td style="text-align:left">在新頁籤中開啟連結</td><td style="text-align:left"><code>true</code></td></tr><tr><td style="text-align:left"><code>external_link.enable</code></td><td style="text-align:left">在新頁籤中開啟連結</td><td style="text-align:left"><code>true</code></td></tr><tr><td style="text-align:left"><code>external_link.field</code></td><td style="text-align:left">Applies to the whole <code>site</code> or <code>post</code> only</td><td style="text-align:left"><code>site</code></td></tr><tr><td style="text-align:left"><code>external_link.exclude</code></td><td style="text-align:left">Exclude hostname. Specify subdomain when applicable, including <code>www</code></td><td style="text-align:left"><code>[]</code></td></tr><tr><td style="text-align:left"><code>filename_case</code></td><td style="text-align:left">把檔案名稱轉換為: <code>1</code> 小寫或 <code>2</code> 大寫</td><td style="text-align:left"><code>0</code></td></tr><tr><td style="text-align:left"><code>render_drafts</code></td><td style="text-align:left">顯示草稿</td><td style="text-align:left"><code>false</code></td></tr><tr><td style="text-align:left"><code>post_asset_folder</code></td><td style="text-align:left">啟動 <a href="https://hexo.io/zh-tw/docs/asset-folders">Asset 資料夾</a></td><td style="text-align:left"><code>false</code></td></tr><tr><td style="text-align:left"><code>relative_link</code></td><td style="text-align:left">把連結改為與根目錄的相對位址</td><td style="text-align:left"><code>false</code></td></tr><tr><td style="text-align:left"><code>future</code></td><td style="text-align:left">顯示未來的文章</td><td style="text-align:left"><code>true</code></td></tr><tr><td style="text-align:left"><code>highlight</code></td><td style="text-align:left">程式碼區塊的設定, see <a href="https://hexo.io/docs/syntax-highlight#Highlight-js">Highlight.js</a> section for usage guide</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>prismjs</code></td><td style="text-align:left">程式碼區塊的設定, see <a href="https://hexo.io/docs/syntax-highlight#PrismJS">PrismJS</a> section for usage guide</td><td style="text-align:left"></td></tr></tbody></table><h4 id="homepage-section"><a class="markdownIt-Anchor" href="#homepage-section"></a> # Homepage Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Home page setting</span><br><span class="line"><span class="meta"># path: Root path for your blogs index page. (default = <span class="string">&#x27;&#x27;)</span></span></span><br><span class="line"><span class="string"><span class="meta"># per_page: Posts displayed per page. (0 = disable pagination)</span></span></span><br><span class="line"><span class="string"><span class="meta"># order_by: Posts order. (Order by date descending by default)</span></span></span><br><span class="line"><span class="string"><span class="meta">index_generator:</span></span></span><br><span class="line"><span class="string"><span class="meta">  path: &#x27;</span>&#x27;</span></span><br><span class="line">  per_page: <span class="number">10</span></span><br><span class="line">  order_by: -date</span><br></pre></td></tr></table></figure><h4 id="category-tag-section"><a class="markdownIt-Anchor" href="#category-tag-section"></a> # Category &amp; Tag Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Category &amp; Tag</span><br><span class="line">default_category: uncategorized</span><br><span class="line">category_map:</span><br><span class="line">tag_map:</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th><th style="text-align:left">預設值</th></tr></thead><tbody><tr><td style="text-align:left"><code>default_category</code></td><td style="text-align:left">預設分類</td><td style="text-align:left"><code>uncategorized</code></td></tr><tr><td style="text-align:left"><code>category_map</code></td><td style="text-align:left">分類別名</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>tag_map</code></td><td style="text-align:left">標籤別名</td><td style="text-align:left"></td></tr></tbody></table><h4 id="date-time-section"><a class="markdownIt-Anchor" href="#date-time-section"></a> # Date &amp; Time Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Date / Time format</span><br><span class="line">## Hexo uses Moment.js to parse and display date</span><br><span class="line">## You can customize the date format as defined in</span><br><span class="line">#<span class="meta"># http:<span class="comment">//momentjs.com/docs/#/displaying/format/</span></span></span><br><span class="line">date_format: YYYY-MM-DD</span><br><span class="line">time_format: HH:mm:ss</span><br><span class="line">## updated_option supports <span class="string">&#x27;mtime&#x27;</span>, <span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;empty&#x27;</span></span><br><span class="line">updated_option: <span class="string">&#x27;mtime&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="pagination-section"><a class="markdownIt-Anchor" href="#pagination-section"></a> # Pagination Section</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Pagination</span><br><span class="line">per_page: 10</span><br><span class="line">pagination_dir: page</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th><th style="text-align:left">預設值</th></tr></thead><tbody><tr><td style="text-align:left"><code>per_page</code></td><td style="text-align:left">一頁顯示的文章量 (<code>0</code> = 關閉分頁功能)</td><td style="text-align:left"><code>10</code></td></tr><tr><td style="text-align:left"><code>pagination_dir</code></td><td style="text-align:left">分頁目錄</td><td style="text-align:left"><code>page</code></td></tr></tbody></table><h4 id="include-exclude-section"><a class="markdownIt-Anchor" href="#include-exclude-section"></a> # Include / Exclude Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Include / Exclude <span class="title function_">file</span><span class="params">(s)</span></span><br><span class="line">#<span class="meta"># <span class="keyword">include</span>:/exclude: options only apply to the <span class="string">&#x27;source/&#x27;</span> folder</span></span><br><span class="line">include:</span><br><span class="line">exclude:</span><br><span class="line">ignore:</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>include</code></td><td style="text-align:left">Hexo 預設會忽略隱藏檔與隱藏資料夾，但列在這個欄位中的檔案，Hexo 仍然會去處理</td></tr><tr><td style="text-align:left"><code>exclude</code></td><td style="text-align:left">列在這裡的檔案將會被 Hexo 忽略</td></tr><tr><td style="text-align:left"><code>ignore</code></td><td style="text-align:left">Ignore files/folders</td></tr></tbody></table><h4 id="extension-section"><a class="markdownIt-Anchor" href="#extension-section"></a> # Extension Section</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:<span class="comment">//hexo.io/plugins/</span></span><br><span class="line">## Themes: https:<span class="comment">//hexo.io/themes/</span></span><br><span class="line">theme: next</span><br><span class="line"></span><br><span class="line"># Deployment</span><br><span class="line">## Docs: https:<span class="comment">//hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:<span class="comment">//github.com/Kiwi0093/Kiwi0093.github.io</span></span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">設定</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>theme</code></td><td style="text-align:left">使用主題名稱, 設為 <code>false</code> 表示關閉主題功能</td></tr><tr><td style="text-align:left"><code>deploy</code></td><td style="text-align:left">佈署設定</td></tr></tbody></table><h5 id="update-2021816"><a class="markdownIt-Anchor" href="#update-2021816"></a> #Update 2021/8/16</h5><p>因為Github修改了政策,所以無法直接在https模式下用帳號/密碼登入,所以deloy的設定得改成以下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://&lt;token&gt;@github.com/Kiwi0093/Kiwi0093.github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>要注意這樣設定的話hexo d -g就不用在輸入username/password但是一旦這個token流出去也會很有問題,最簡單的解就是把整個repo改成private這樣可以多少減少問題</p><h2 id="hexo使用方式"><a class="markdownIt-Anchor" href="#hexo使用方式"></a> Hexo使用方式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#清除建立好的資料</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="comment">#建立靜態網頁</span></span><br><span class="line">hexo g</span><br><span class="line"><span class="comment">#啟動Local Server</span></span><br><span class="line">hexo s</span><br><span class="line"><span class="comment">#Deploy到Server上</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><h3 id="hexo剛建好的時候需要手動建立以下頁面"><a class="markdownIt-Anchor" href="#hexo剛建好的時候需要手動建立以下頁面"></a> Hexo剛建好的時候需要手動建立以下頁面</h3><ul><li><p>新增一個分類主頁：<code>hexo new page categories</code></p></li><li><p>新增一個Tag主頁：<code>hexo new page tags</code></p><p>在 <code>source/tags/index.md</code> 编辑:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">type: <span class="string">&quot;tags&quot;</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure></li></ul><h3 id="hexo使用其他configyml的方法"><a class="markdownIt-Anchor" href="#hexo使用其他configyml的方法"></a> Hexo使用其他config.yml的方法</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 使用自訂的 <span class="string">&#x27;custom.yml&#x27;</span> 取代預設的 <span class="string">&#x27;_config.yml&#x27;</span></span><br><span class="line">$ hexo server --config custom.yml</span><br><span class="line"></span><br><span class="line"># 使用多個配置檔, 有衝突時優先使用 <span class="string">&#x27;custom2.json&#x27;</span></span><br><span class="line">$ hexo server --config custom.yml,custom2.json</span><br></pre></td></tr></table></figure><h2 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h2><p><a href="https://ohlia.github.io/Wiki-site/wiki/Hexo/build-blog-by-hexo/">OHLIA’s Wiki</a></p><p><a href="https://hexo.io/zh-tw/docs/">Hexo的官方文件</a></p><h2 id="同場加映"><a class="markdownIt-Anchor" href="#同場加映"></a> 同場加映</h2><p>最近更新後常常會有</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">FATAL YAMLException: unknown tag !&lt;tag:yaml.org,2002:js/regexp&gt; (116:49)</span><br><span class="line"></span><br><span class="line"> 113 |  ... ttributes: <span class="literal">true</span></span><br><span class="line"> 114 |  ... ce: <span class="literal">true</span></span><br><span class="line"> 115 |  ... ore --&gt;<span class="string">&#x27; https://hexo.io/docs/tag-plugins#Post-Excerpt</span></span><br><span class="line"><span class="string"> 116 |  ... ents: [ !!js/regexp /^\s*more/]</span></span><br><span class="line"><span class="string">------------------------------------------^</span></span><br><span class="line"><span class="string"> 117 |  ... true</span></span><br><span class="line"><span class="string"> 118 |  ... butes: true</span></span><br><span class="line"><span class="string">    at generateError (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:183:10)</span></span><br><span class="line"><span class="string">    at throwError (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:187:9)</span></span><br><span class="line"><span class="string">    at composeNode (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1521:7)</span></span><br><span class="line"><span class="string">    at readFlowCollection (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:780:5)</span></span><br><span class="line"><span class="string">    at composeNode (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1442:11)</span></span><br><span class="line"><span class="string">    at readBlockMapping (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1164:11)</span></span><br><span class="line"><span class="string">    at composeNode (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1441:12)</span></span><br><span class="line"><span class="string">    at readBlockMapping (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1164:11)</span></span><br><span class="line"><span class="string">    at composeNode (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1441:12)</span></span><br><span class="line"><span class="string">    at readDocument (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1625:3)</span></span><br><span class="line"><span class="string">    at loadDocuments (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1688:5)</span></span><br><span class="line"><span class="string">    at Object.load (/home/kiwi/GitHub/Wiki-site/node_modules/js-yaml/lib/loader.js:1714:19)</span></span><br><span class="line"><span class="string">    at Hexo.yamlHelper (/home/kiwi/GitHub/Wiki-site/node_modules/hexo/lib/plugins/renderer/yaml.js:7:15)</span></span><br><span class="line"><span class="string">    at Hexo.tryCatcher (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/util.js:16:23)</span></span><br><span class="line"><span class="string">    at Hexo.&lt;anonymous&gt; (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/method.js:15:34)</span></span><br><span class="line"><span class="string">    at /home/kiwi/GitHub/Wiki-site/node_modules/hexo/lib/hexo/render.js:75:22</span></span><br><span class="line"><span class="string">    at tryCatcher (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/util.js:16:23)</span></span><br><span class="line"><span class="string">    at Promise._settlePromiseFromHandler (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/promise.js:547:31)</span></span><br><span class="line"><span class="string">    at Promise._settlePromise (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/promise.js:604:18)</span></span><br><span class="line"><span class="string">    at Promise._settlePromise0 (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/promise.js:649:10)</span></span><br><span class="line"><span class="string">    at Promise._settlePromises (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/promise.js:729:18)</span></span><br><span class="line"><span class="string">    at _drainQueueStep (/home/kiwi/GitHub/Wiki-site/node_modules/bluebird/js/release/async.js:93:12) &#123;</span></span><br><span class="line"><span class="string">  reason: &#x27;</span>unknown tag !&lt;tag:yaml.org,2002:js/regexp&gt;<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">.......</span></span><br></pre></td></tr></table></figure><p>這樣的錯誤訊息跑出來,解決方案如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /under/your/web/_config.yml</span></span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">....</span><br><span class="line">html_minifier:  </span><br><span class="line">  collapseBooleanAttributes: <span class="literal">true</span></span><br><span class="line">  collapseWhitespace: <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Ignore &#x27;&lt;!-- more --&gt;&#x27; https://hexo.io/docs/tag-plugins#Post-Excerpt</span></span><br><span class="line">  <span class="comment">#ignoreCustomComments: [ !!js/regexp /^\s*more/]#把這行Mark掉就好了</span></span><br><span class="line">  removeComments: <span class="literal">true</span></span><br><span class="line">  removeEmptyAttributes: <span class="literal">true</span></span><br><span class="line">  removeScriptTypeAttributes: <span class="literal">true</span></span><br><span class="line">  removeStyleLinkTypeAttributes: <span class="literal">true</span></span><br><span class="line">  minifyJS: <span class="literal">true</span></span><br><span class="line">  minifyCSS: <span class="literal">true</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;hexo本體設定&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#hexo本體設定&quot;&gt;&lt;/a&gt; Hexo本體設定&lt;/h2&gt;
&lt;p&gt;Hexo本體的設定均在&lt;code&gt;&amp;lt;folder&amp;gt;/_config.yml&lt;/code&gt;裡面,大多數的設定都可以直接沿用很方便只有一些部分需要修改調整&lt;/p&gt;
&lt;p&gt;詳細的&lt;a href=&quot;https://hexo.io/docs/configuration.html&quot;&gt;Hexo Configuration&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Hexo" scheme="http://kiwi0093.github.io/wiki/categories/Network/Hexo/"/>
    
    
    <category term="Git" scheme="http://kiwi0093.github.io/wiki/tags/Git/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="Server" scheme="http://kiwi0093.github.io/wiki/tags/Server/"/>
    
    <category term="Blog" scheme="http://kiwi0093.github.io/wiki/tags/Blog/"/>
    
    <category term="Wiki" scheme="http://kiwi0093.github.io/wiki/tags/Wiki/"/>
    
  </entry>
  
  <entry>
    <title>Next Theme的安裝與設定</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Hexo/5-Next_theme/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Hexo/5-Next_theme/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>Next主題是一個很漂亮的Blog主題/風格,安裝起來也非常簡單用npm直接下指令安裝就好了</p><span id="more"></span><h1 id="安裝"><a class="markdownIt-Anchor" href="#安裝"></a> 安裝</h1><p><a href="https://github.com/next-theme/hexo-theme-next">Next Theme官網</a>上有兩種安裝方式</p><ul><li><p>透過npm直接安裝(需要Hexo5.0以上版本)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在Hexo目錄下</span></span><br><span class="line">npm install hexo-theme-next</span><br></pre></td></tr></table></figure><p>安裝後直接變更Hexo目錄的<code>_config.yml</code>內的theme部分就可以用了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure></li><li><p><font color=red><del>透過Git指令直接clone整個theme到Hexo的theme目錄</del></font> V8後基本上都用<code>npm</code>安裝</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在Hexo目錄下</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/next-theme/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><p>安裝後一樣要變更Hexo目錄的<code>_config.yml</code></p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure><h1 id="設定"><a class="markdownIt-Anchor" href="#設定"></a> 設定</h1><h2 id="theme-setting"><a class="markdownIt-Anchor" href="#theme-setting"></a> #Theme Setting</h2><p>將Theme的<code>_config.yml</code>複製為<code>_config.[Theme_name].yml</code></p><p>詳細的說明可以參考<a href="https://theme-next.js.org/docs/getting-started/configuration.html">官方的文件說明</a></p><p>基本上只需要修改下述幾個主要參數就可以了</p><h2 id="choosing-scheme"><a class="markdownIt-Anchor" href="#choosing-scheme"></a> #Choosing Scheme</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># ---------------------------------------------------------------</span><br><span class="line"># Scheme Settings</span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># Schemes</span><br><span class="line">#scheme: Muse</span><br><span class="line">scheme: Mist</span><br><span class="line">#scheme: Pisces</span><br><span class="line">#scheme: Gemini</span><br><span class="line"></span><br><span class="line"># Dark Mode</span><br><span class="line">darkmode: true</span><br></pre></td></tr></table></figure><p>有四種scheme可以挑選,官網上有範例可以參考<a href="https://theme-next.js.org/muse/">Muse</a>, <a href="https://theme-next.js.org/mist/">Mist</a>, <a href="https://theme-next.js.org/pisces/">Pisces</a>, <a href="https://theme-next.js.org/">Gemini</a>可以自行挑選後修改設定啟用</p><p>另外現在Next官方支援Darkmode,預設是false,修改成true後可以變成darkmode</p><h3 id="手動切換darkmode"><a class="markdownIt-Anchor" href="#手動切換darkmode"></a> #手動切換Darkmode</h3><h4 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h4><p><a href="https://www.techgrow.cn/posts/abf4aee1.html">Clay 的技术博客</a></p><h3 id="設定方式"><a class="markdownIt-Anchor" href="#設定方式"></a> 設定方式</h3><h4 id="安裝plug-in"><a class="markdownIt-Anchor" href="#安裝plug-in"></a> 安裝Plug-in</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-next-darkmode --save</span><br></pre></td></tr></table></figure><h4 id="設定-2"><a class="markdownIt-Anchor" href="#設定-2"></a> 設定</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_config.next.yml</span></span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment"># disable default Darkmode</span></span><br><span class="line">darkmode: <span class="literal">false</span></span><br><span class="line"><span class="comment"># add below</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Darkmode JS</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/rqh656418510/hexo-next-darkmode, https://github.com/sandoche/Darkmode.js</span></span><br><span class="line">darkmode_js:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  bottom: <span class="string">&#x27;64px&#x27;</span> <span class="comment"># default: &#x27;32px&#x27;</span></span><br><span class="line">  right: <span class="string">&#x27;unset&#x27;</span> <span class="comment"># default: &#x27;32px&#x27;</span></span><br><span class="line">  left: <span class="string">&#x27;32px&#x27;</span> <span class="comment"># default: &#x27;unset&#x27;</span></span><br><span class="line">  time: <span class="string">&#x27;0.5s&#x27;</span> <span class="comment"># default: &#x27;0.3s&#x27;</span></span><br><span class="line">  mixColor: <span class="string">&#x27;transparent&#x27;</span> <span class="comment"># default: &#x27;#fff&#x27;</span></span><br><span class="line">  backgroundColor: <span class="string">&#x27;transparent&#x27;</span> <span class="comment"># default: &#x27;#fff&#x27;</span></span><br><span class="line">  buttonColorDark: <span class="string">&#x27;#100f2c&#x27;</span> <span class="comment"># default: &#x27;#100f2c&#x27;</span></span><br><span class="line">  buttonColorLight: <span class="string">&#x27;#fff&#x27;</span> <span class="comment"># default: &#x27;#fff&#x27;</span></span><br><span class="line">  isActivated: <span class="literal">false</span> <span class="comment"># default false</span></span><br><span class="line">  saveInCookies: <span class="literal">true</span> <span class="comment"># default: true</span></span><br><span class="line">  label: <span class="string">&#x27;🌓&#x27;</span> <span class="comment"># default: &#x27;&#x27;</span></span><br><span class="line">  autoMatchOsTheme: <span class="literal">true</span> <span class="comment"># default: true</span></span><br><span class="line">  libUrl: <span class="comment"># Set custom library cdn url for Darkmode.js</span></span><br></pre></td></tr></table></figure><ul><li><code>isActivated: true</code>：默認使用Darkmode，始終搭配 <code>saveInCookies: false</code>、<code>autoMatchOsTheme: false</code></li></ul><h2 id="menu"><a class="markdownIt-Anchor" href="#menu"></a> Menu</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># ---------------------------------------------------------------</span><br><span class="line"># Menu Settings</span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">menu:</span><br><span class="line">  home: / || fa fa-home</span><br><span class="line">  <span class="meta">#about: /about/ || fa fa-user</span></span><br><span class="line">  tags: /tags/ || fa fa-tags</span><br><span class="line">  categories: /categories/ || fa fa-th</span><br><span class="line">  archives: /archives/ || fa fa-archive</span><br><span class="line">  <span class="meta">#schedule: /schedule/ || fa fa-calendar</span></span><br><span class="line">  <span class="meta">#sitemap: /sitemap.xml || fa fa-sitemap</span></span><br><span class="line">  <span class="meta">#commonweal: /404/ || fa fa-heartbeat</span></span><br><span class="line">  wiki: https:<span class="comment">//kiwi0093.github.io/Wiki-site/ || fa fa-sitemap</span></span><br><span class="line"></span><br><span class="line"># Enable / Disable menu icons / item badges.</span><br><span class="line">menu_settings:</span><br><span class="line">  icons: <span class="literal">true</span></span><br><span class="line">  badges: <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>編輯這個部分可以簡易做出Blog框架內的選單,在官方文件內還有介紹出可以分層的Menu寫法,如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || fa fa-home</span><br><span class="line">  archives: /archives/ || fa fa-archive</span><br><span class="line">  Docs:</span><br><span class="line">    <span class="keyword">default</span>: /docs/ || fa fa-book</span><br><span class="line">    Getting Started:</span><br><span class="line">      <span class="keyword">default</span>: /getting-started/ || fa fa-flag</span><br><span class="line">      Installation: /installation.html || fa fa-download</span><br><span class="line">      Configuration: /configuration.html || fa fa-wrench</span><br><span class="line">    Third Party Services:</span><br><span class="line">      <span class="keyword">default</span>: /third-party-services/ || fa fa-puzzle-piece</span><br><span class="line">      Math Equations: /math-equations.html || fa fa-square-root-alt</span><br><span class="line">      Comment Systems: /comments.html || fa fa-comment-alt</span><br></pre></td></tr></table></figure><p>其他的細部設定就參考官方文件設定即可</p><p>在現在的架構下務必要加上</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wiki: https:<span class="comment">//kiwi0093.github.io/Wiki-site/ || fa fa-sitemap</span></span><br></pre></td></tr></table></figure><p>才會建立Wiki的Link</p><h2 id="留言功能"><a class="markdownIt-Anchor" href="#留言功能"></a> 留言功能</h2><p>我搞了一圈最後還是選擇使用<font color=red><del>Disqus+DisqusJS</del></font>自己搭建的isso</p><h3 id="font-colorreddel參考資料delfont"><a class="markdownIt-Anchor" href="#font-colorreddel參考資料delfont"></a> <font color=red><del>參考資料</del></font></h3><ul><li><a href="https://laoqingcai.com/">老青菜</a></li><li><a href="https://github.com/SukkaW/DisqusJS">DisqusJS Github</a></li></ul><h3 id="font-colorreddel申請disqus帳號這個delfont"><a class="markdownIt-Anchor" href="#font-colorreddel申請disqus帳號這個delfont"></a> <font color=red><del>申請Disqus帳號這個</del></font></h3><p><font color=red><del>這個去官網申請就好了,申請完後記得連API一起弄一下(參考<a href="https://github.com/SukkaW/DisqusJS">DisqusJS Github</a>的作法)</del></font></p><h3 id="font-colorreddel設定檔delfont"><a class="markdownIt-Anchor" href="#font-colorreddel設定檔delfont"></a> <font color=red><del>設定檔</del></font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_config.next.yml</span></span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment"># Disqus</span></span><br><span class="line">disqus:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  shortname: <span class="variable">$&#123;your_shortname&#125;</span></span><br><span class="line">  count: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DisqusJS</span></span><br><span class="line"><span class="comment"># Alternative Disqus - Render comment component using Disqus API.</span></span><br><span class="line"><span class="comment"># Demo: https://suka.js.org/DisqusJS/</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/SukkaW/DisqusJS</span></span><br><span class="line">disqusjs:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  <span class="comment"># API Endpoint of Disqus API (https://disqus.com/api/).</span></span><br><span class="line">  <span class="comment"># Leave api empty if you are able to connect to Disqus API. Otherwise you need a reverse proxy for it.</span></span><br><span class="line">  <span class="comment"># For example:</span></span><br><span class="line">  <span class="comment"># api: https://disqus.skk.moe/disqus/</span></span><br><span class="line">  api:</span><br><span class="line">  apikey: <span class="variable">$&#123;Your_API_KEY&#125;</span> <span class="comment"># Register new application from https://disqus.com/api/applications/</span></span><br><span class="line">  shortname: <span class="variable">$&#123;your_shortname&#125;</span> <span class="comment"># See: https://disqus.com/admin/settings/general/</span></span><br></pre></td></tr></table></figure><p><font color=red><del>好了之後<code>hexo clean</code>,<code>hexo d -g</code>就好了</del></font></p><h3 id="isso-參考"><a class="markdownIt-Anchor" href="#isso-參考"></a> ISSO - 參考</h3><p>請參考另外一篇<a href="https://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/10-isso/">Isso comment system for Hexo Blog | Kiwi’s Wiki (kiwi0093.github.io)</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;Next主題是一個很漂亮的Blog主題/風格,安裝起來也非常簡單用npm直接下指令安裝就好了&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Hexo" scheme="http://kiwi0093.github.io/wiki/categories/Network/Hexo/"/>
    
    
    <category term="Git" scheme="http://kiwi0093.github.io/wiki/tags/Git/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="Server" scheme="http://kiwi0093.github.io/wiki/tags/Server/"/>
    
    <category term="Blog" scheme="http://kiwi0093.github.io/wiki/tags/Blog/"/>
    
  </entry>
  
  <entry>
    <title>Wikitten Theme的安裝與設定</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Hexo/6-Wikitten_theme/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Hexo/6-Wikitten_theme/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>這是我這個Wiki站的主體框架,除了一部分的配色我會自己改一下以外其他部份都原汁原味</p><span id="more"></span><h3 id="安裝"><a class="markdownIt-Anchor" href="#安裝"></a> 安裝</h3><p>這個Theme安裝相較之下就簡單很多,只有<code>git clone</code>的安裝方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在Hexo目錄下</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zthxxx/hexo-theme-Wikitten.git themes/Wikitten</span><br></pre></td></tr></table></figure><p>複製以下檔案</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -rf themes/Wikitten/_source/* <span class="built_in">source</span>/</span><br><span class="line"><span class="built_in">cp</span> -rf themes/Wikitten/_scaffolds/* scaffolds/</span><br><span class="line"><span class="built_in">cp</span> -f themes/Wikitten/_config.yml.example _config.Wikitten.yml</span><br></pre></td></tr></table></figure><p>安裝以下Plugin</p><ul><li>hexo-autonofollow    // 打开非本站链接时自动开启新标签页</li><li>hexo-directory-category // 根据文章文件目录自动为文章添加分类</li><li>hexo-generator-feed    // 生成 RSS 源</li><li>hexo-generator-json-content// 生成全站文章 json 内容，用于全文搜索</li><li>hexo-generator-sitemap// 生成全站站点地图 sitemap</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -S hexo-autonofollow hexo-directory-category hexo-generator-feed hexo-generator-json-content hexo-generator-sitemap</span><br></pre></td></tr></table></figure><p>修改<code>_config.yml</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: Wikitten</span><br></pre></td></tr></table></figure><h3 id="設定"><a class="markdownIt-Anchor" href="#設定"></a> 設定</h3><h4 id="hexo本體"><a class="markdownIt-Anchor" href="#hexo本體"></a> Hexo本體</h4><p>依照原始架構設想,Wiki會被另外裝到<code>Wiki-site</code>裡面,所以<code>_config.yml</code>內屬於Wiki的有一部分要修改</p><h4 id="site-url"><a class="markdownIt-Anchor" href="#site-url"></a> #Site &amp; URL</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: Kiwi<span class="number">&#x27;</span>s Wiki</span><br><span class="line">subtitle: </span><br><span class="line">description: <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">keywords:</span></span><br><span class="line"><span class="string">author: Kiwi</span></span><br><span class="line"><span class="string">language: en</span></span><br><span class="line"><span class="string">timezone: &#x27;</span>&#x27;</span><br><span class="line"></span><br><span class="line"># URL</span><br><span class="line">## If your site is put in a subdirectory, <span class="built_in">set</span> url as <span class="string">&#x27;http://example.com/child&#x27;</span> and root as <span class="string">&#x27;/child/&#x27;</span></span><br><span class="line">url: http:<span class="comment">//Kiwi0093.github.io/Wiki-site</span></span><br><span class="line">root: /Wiki-site</span><br><span class="line">permalink: wiki/:title/</span><br><span class="line">permalink_defaults:</span><br><span class="line">pretty_urls:</span><br><span class="line">  trailing_index: <span class="literal">true</span> # Set to <span class="literal">false</span> to remove trailing <span class="string">&#x27;index.html&#x27;</span> from permalinks</span><br><span class="line">  trailing_html: <span class="literal">true</span> # Set to <span class="literal">false</span> to remove trailing <span class="string">&#x27;.html&#x27;</span> from permalinks</span><br></pre></td></tr></table></figure><p>因為是Wiki-Site,所以root部分要變更為<code>/Wiki-site</code>,並且將permalink修改為<code>wiki/:title/</code></p><h4 id="目錄"><a class="markdownIt-Anchor" href="#目錄"></a> #目錄</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Directory</span><br><span class="line">source_dir: source</span><br><span class="line">public_dir: public</span><br><span class="line">tag_dir: tags</span><br><span class="line">archive_dir: archives</span><br><span class="line">category_dir: categories</span><br><span class="line">code_dir: downloads/code</span><br><span class="line">i18n_dir: :lang</span><br><span class="line">skip_render:</span><br><span class="line">  - README.md</span><br><span class="line">  - <span class="string">&#x27;_posts/**/embed_page/**&#x27;</span></span><br></pre></td></tr></table></figure><p>在<code>skip_render</code>後加上</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- README.md</span><br><span class="line">- <span class="string">&#x27;_posts/**/embed_page/**&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="theme-deploy"><a class="markdownIt-Anchor" href="#theme-deploy"></a> #theme &amp; deploy</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:<span class="comment">//hexo.io/plugins/</span></span><br><span class="line">## Themes: https:<span class="comment">//hexo.io/themes/</span></span><br><span class="line">theme: Wikitten</span><br><span class="line"></span><br><span class="line"># Deployment</span><br><span class="line">## Docs: https:<span class="comment">//hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:<span class="comment">//github.com/Kiwi0093/Wiki-site</span></span><br><span class="line">  branch: gh-pages</span><br></pre></td></tr></table></figure><p>deploy的部分需要把branch改成<code>gh-pages</code>確保網頁會到<a href="https://kiwi0093.github.io/Wiki-site/">https://kiwi0093.github.io/Wiki-site/</a></p><h4 id="wikitten主題設定"><a class="markdownIt-Anchor" href="#wikitten主題設定"></a> Wikitten主題設定</h4><h5 id="menu"><a class="markdownIt-Anchor" href="#menu"></a> #Menu</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Menus</span><br><span class="line">menu:</span><br><span class="line">  首頁: /</span><br><span class="line">  歸檔: /archives</span><br><span class="line">  分類: /categories</span><br><span class="line">  標籤: /tags</span><br><span class="line">  關於: /about</span><br><span class="line">  Blog : https:<span class="comment">//Kiwi0093.github.io</span></span><br></pre></td></tr></table></figure><p>記得加上<code>Blog : https://Kiwi0093.github.io</code>確保Wiki頁面上有連回Blog的連結</p><h5 id="customize"><a class="markdownIt-Anchor" href="#customize"></a> #Customize</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># Customize</span><br><span class="line">customize:</span><br><span class="line">    logo:</span><br><span class="line">        enabled: <span class="literal">true</span></span><br><span class="line">        width: <span class="number">40</span></span><br><span class="line">        height: <span class="number">40</span></span><br><span class="line">        url: /logo.png</span><br><span class="line">    profile:</span><br><span class="line">        enabled: <span class="literal">false</span> # Whether to show profile bar</span><br><span class="line">        avatar: <span class="meta"># css/images/avatar.png</span></span><br><span class="line">        gravatar: Kiwi@kaienroid.com # Gravatar email address, <span class="keyword">if</span> you enable Gravatar, your avatar config will be overriden</span><br><span class="line">        author: Kiwi</span><br><span class="line">        author_title: Designer &amp; Programmer</span><br><span class="line">        location: Taipei, Taiwan</span><br><span class="line">        follow: https:<span class="comment">//github.com/Kiwi0093/</span></span><br><span class="line">    highlight: monokai</span><br><span class="line">    sidebar: left <span class="meta"># sidebar position, options: left, right</span></span><br><span class="line">    category_perExpand: <span class="literal">false</span> <span class="meta"># enable article categories list per expanding</span></span><br><span class="line">    thumbnail: <span class="literal">true</span> <span class="meta"># enable posts thumbnail, options: true, false</span></span><br><span class="line">    favicon: /favicon.ico <span class="meta"># path to favicon</span></span><br><span class="line">    default_index_file: index.md <span class="meta"># <span class="keyword">if</span> this, it will display at site index instead of default index page</span></span><br><span class="line">    social_links:</span><br><span class="line">        github: https:<span class="comment">//github.com/Kiwi0093/Kiwi0093.github.io</span></span><br><span class="line">        rss: /atom.xml</span><br><span class="line">    social_link_tooltip: <span class="literal">true</span> <span class="meta"># enable the social link tooltip, options: true, false</span></span><br></pre></td></tr></table></figure><p>這個部分主要是設定框架</p><h5 id="widget"><a class="markdownIt-Anchor" href="#widget"></a> #Widget</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Widgets</span><br><span class="line">widgets: <span class="meta"># default use category only</span></span><br><span class="line">    - category</span><br><span class="line">    # - recent_posts</span><br><span class="line">    # - archive</span><br><span class="line">    # - tag</span><br><span class="line">    # - tagcloud</span><br><span class="line">    # - links</span><br></pre></td></tr></table></figure><p>這個可以設定有哪些會列出來在左右側的框架內</p><h5 id="歷史版本確認"><a class="markdownIt-Anchor" href="#歷史版本確認"></a> #歷史版本確認</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># History version </span><br><span class="line">history_control: <span class="meta"># make you wiki has history version control in page</span></span><br><span class="line">    enable: <span class="literal">true</span></span><br><span class="line">    server_link: https:<span class="comment">//github.com # recommend use GitHub https://github.com</span></span><br><span class="line">    user: Kiwi0093</span><br><span class="line">    repertory: Wiki-site</span><br><span class="line">    branch: master</span><br></pre></td></tr></table></figure><p>這部分可以讓Wiki的歷史版本直接跟github的版本控制連動</p><h3 id="變更顏色"><a class="markdownIt-Anchor" href="#變更顏色"></a> 變更顏色</h3><p><code>themes/Wikitten/source/css/_variables.styl</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Colors</span></span><br><span class="line">color-<span class="keyword">default</span> = #<span class="number">565</span>a5f</span><br><span class="line">color-grey = #<span class="number">999</span></span><br><span class="line">color-border = #dfe1e2</span><br><span class="line">color-border-stretch = #c1cfdc</span><br><span class="line">color-link = #eb783b <span class="comment">//#38b7ea</span></span><br><span class="line">color-background = #ebeef1</span><br><span class="line">color-meta-head = #<span class="number">7b</span>848c</span><br><span class="line">color-sidebar-text = #<span class="number">777</span></span><br><span class="line">color-sidebar-text-dark = #<span class="number">333</span></span><br><span class="line">color-widget-background = <span class="meta">#ddd</span></span><br><span class="line">color-widget-border = <span class="meta">#ccc</span></span><br></pre></td></tr></table></figure><p>個人會把Link的顏色從藍色<code>#38b7ea</code>變更為橘色<code>#eb783b</code></p><p>顏色的選擇可以使用google查詢任意一個顏色的HEX code,就會有google的小工具可以使用了</p><p><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/google_color.PNG" alt="google_color" /></p><h3 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h3><p><a href="http://www.lzszy.com/wiki/2018-12-16-Hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E4%BD%BF%E7%94%A8Wikitten%E4%B8%BB%E9%A2%98/">A Learning Blog</a></p><p><a href="https://wiki.zthxxx.me/">Theme作者Zthxxx’s Wiki</a></p><p><a href="https://github.com/zthxxx/hexo-theme-Wikitten">Theme Wiki</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;這是我這個Wiki站的主體框架,除了一部分的配色我會自己改一下以外其他部份都原汁原味&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Hexo" scheme="http://kiwi0093.github.io/wiki/categories/Network/Hexo/"/>
    
    
    <category term="Git" scheme="http://kiwi0093.github.io/wiki/tags/Git/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="Server" scheme="http://kiwi0093.github.io/wiki/tags/Server/"/>
    
    <category term="Wiki" scheme="http://kiwi0093.github.io/wiki/tags/Wiki/"/>
    
  </entry>
  
  <entry>
    <title>V2ray Behide Traefik</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/V2Ray/4-v2ray_behide_traefik/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/V2Ray/4-v2ray_behide_traefik/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>若是要讓VPS除了V2ray以外還可以跑其他的Web Service, 除了Nginx/Apache的Virtual Host方案外還可以採用Traefik(Container專用)</p><p>但是單純V2ray+Traefik的搭配時,ACME申請SSL憑證這個地方因為沒有實際的httpd服務而失敗卡死，所以還是會需要一個Nginx</p><span id="more"></span><h2 id="configjson-for-v2ray"><a class="markdownIt-Anchor" href="#configjson-for-v2ray"></a> Config.json for V2ray</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># /var/lib/docker/volume/v2ray/config.json</span><br><span class="line">-----------------------------------------------------</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;log&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;loglevel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;warning&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;inbounds&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> &lt;Port_You_Want&gt;<span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;listen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;protocol&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vless&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;settings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;clients&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;UUID_You_Want&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;level&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                       <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;Mail_Address_You_Want&gt;&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;decryption&quot;</span><span class="punctuation">:</span> <span class="string">&quot;none&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;streamSettings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ws&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;security&quot;</span><span class="punctuation">:</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;wsSettings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&lt;Path_You_Want&gt;&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;outbounds&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;protocol&quot;</span><span class="punctuation">:</span> <span class="string">&quot;freedom&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>簡單的說明一下,就是把原來當作接口用的443 Port部份那段拿掉,回歸早期透過Caddy/Apache/Nginx做代轉的寫法</p><h1 id="default-for-nginx"><a class="markdownIt-Anchor" href="#default-for-nginx"></a> Default for Nginx</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /var/lib/docker/volumes/nginx/config/nginx/site-confs/default</span></span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">server &#123;</span><br><span class="line">    server_name _;</span><br><span class="line">    listen 80;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /var/www/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /ray &#123;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        proxy_pass http://v2ray:&lt;Port_You_Want&gt;;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">        proxy_set_header Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>利用Links把兩個Container連在一起，可以直接用<a href="http://xn--v2ray-hi8iq75bex8bpc2b">http://v2ray指定轉移</a></p><h1 id="docker-composeyml"><a class="markdownIt-Anchor" href="#docker-composeyml"></a> Docker-Compose.yml</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.7&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">lscr.io/linuxserver/nginx</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">Nginx_v2ray</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PUID=1000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PGID=1000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Taipei</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/lib/docker/volumes/nginx/config:/config</span></span><br><span class="line">    <span class="attr">links:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">v2ray:v2ray</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">traefik.enable:</span> <span class="literal">true</span> </span><br><span class="line">      <span class="attr">traefik.http.routers.v2ray.rule:</span> <span class="string">Host(`&lt;domain.you.want&gt;`)</span> </span><br><span class="line">      <span class="attr">traefik.http.routers.v2ray.tls:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">traefik.http.routers.v2ray.tls.certresolver:</span> <span class="string">myresolver</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">v2ray:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">v2fly/v2fly-core</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">v2ray</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Taipei</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">v2ray</span> <span class="string">--config=/etc/v2ray/config.json</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/lib/docker/volumes/v2ray:/etc/v2ray</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">default:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">traefik_backend</span></span><br></pre></td></tr></table></figure><ul><li>用nginx當作整個服務的前端去對應traefik</li><li>後面的v2ray完整的躲起來連expose都不需要</li><li>這樣子更新的時候才不會因為特殊的image更新比較慢而產生問題(有整合的image但是兩年沒更新了…)</li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;若是要讓VPS除了V2ray以外還可以跑其他的Web Service, 除了Nginx/Apache的Virtual Host方案外還可以採用Traefik(Container專用)&lt;/p&gt;
&lt;p&gt;但是單純V2ray+Traefik的搭配時,ACME申請SSL憑證這個地方因為沒有實際的httpd服務而失敗卡死，所以還是會需要一個Nginx&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="V2Ray" scheme="http://kiwi0093.github.io/wiki/categories/Network/V2Ray/"/>
    
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="V2Ray" scheme="http://kiwi0093.github.io/wiki/tags/V2Ray/"/>
    
    <category term="VPN" scheme="http://kiwi0093.github.io/wiki/tags/VPN/"/>
    
  </entry>
  
  <entry>
    <title>Photon OS 4.0 GA</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/PhotonOS%20&amp;%20Docker%20Basic/1-PhotonOS/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/PhotonOS%20&amp;%20Docker%20Basic/1-PhotonOS/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>由於打算把所有的網路服務都逐步改成docker的方式,所以打算把底層的系統也換成Vmware針對docker等容器特化版的Linux - PhotoOS</p><span id="more"></span><h1 id="installation"><a class="markdownIt-Anchor" href="#installation"></a> Installation</h1><ol><li><a href="https://github.com/vmware/photon/wiki/Downloading-Photon-OS">下載Image ISO</a></li><li>然後在VMware workstation或VMware Esxi上建立新的VM(選擇VMware PhotonOS 64 bits或是Linux Kernel最新的64bits都可以)</li><li>用光碟開機後依照步驟做就好了</li></ol><p>基本上這個系統需要的RAM跟空間很小,但是你會需要RAM跟空間來跑Docker.所以在建立的時候請考慮你要使用的服務數量來設定你的RAM跟空間</p><h1 id="basic-setup"><a class="markdownIt-Anchor" href="#basic-setup"></a> Basic Setup</h1><h2 id="確認基本服務"><a class="markdownIt-Anchor" href="#確認基本服務"></a> 確認基本服務</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#看一下基本的系統服務是否有開啟,例如open-vm-tools</span></span><br><span class="line">systemctl status vmtoolsd.service</span><br></pre></td></tr></table></figure><h2 id="帳號設定"><a class="markdownIt-Anchor" href="#帳號設定"></a> 帳號設定</h2><p>安裝的時候就會設定root密碼了,可以利用useradd再增加一般使用者(為了安全性)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#增加使用者</span></span><br><span class="line">useradd -m -g root $(your_id)</span><br><span class="line"><span class="comment">#替你的帳號設定密碼</span></span><br><span class="line">passwd $(your_id)</span><br></pre></td></tr></table></figure><p>因為使用上還是很常會需要root權限,所以可以依照個人喜好決定是否要建立額外帳號然後登入後用<code>su</code>或是<code>sudo</code>或是直接修改/etc/ssh/sshd_config改成允許root ssh登入都可以</p><h2 id="網路設定"><a class="markdownIt-Anchor" href="#網路設定"></a> 網路設定</h2><h3 id="systemd-networkd"><a class="markdownIt-Anchor" href="#systemd-networkd"></a> Systemd-Networkd</h3><h4 id="基本規則"><a class="markdownIt-Anchor" href="#基本規則"></a> 基本規則</h4><p>參考網頁<a href="https://wiki.archlinux.org/title/systemd-networkd">systemd-networkd@ArchWiKi</a></p><p>安裝後的系統預設是dhcp開啟的狀態,若是只要單ip並且有另外的dhcpd加上Mac Address控制的話是可以不用動,有其他需求的需要去修改以下檔案</p><h4 id="關閉dhcp"><a class="markdownIt-Anchor" href="#關閉dhcp"></a> 關閉DHCP</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/etc/systemd/network/99-dhcp-en.network</span></span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">[match]</span><br><span class="line">Name=e*</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">DHCP=<span class="built_in">yes</span>    <span class="comment">#這個改成no來關閉dhcp</span></span><br><span class="line">IPv6AcceptRA=no</span><br></pre></td></tr></table></figure><h4 id="固定ip設定方法"><a class="markdownIt-Anchor" href="#固定ip設定方法"></a> 固定IP設定方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/etc/systemd/network/10-static-en.network</span></span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">[Match]</span><br><span class="line">Name=ens160                                <span class="comment">#網卡名稱</span></span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">Address=10.1.10.9/24                    <span class="comment">#IP位置,可重複多次定義多個IP</span></span><br><span class="line">Gateway=10.1.10.1                        <span class="comment">#Gateway IP</span></span><br><span class="line">DNS=10.1.10.1                            <span class="comment">#DNS IP</span></span><br><span class="line"><span class="comment"># NTP設定,用空白隔開不同Server</span></span><br><span class="line">NTP=tock.stdtime.gov.tw watch.stdtime.gov.tw time.stdtime.gov.tw clock.stdtime.gov.tw tick.stdtime.gov.tw</span><br><span class="line"><span class="comment"># 關閉IPV6</span></span><br><span class="line">LinkLocalAddressing=no</span><br><span class="line">IPv6AcceptRA=no</span><br></pre></td></tr></table></figure><h4 id="設定網路介面名稱"><a class="markdownIt-Anchor" href="#設定網路介面名稱"></a> 設定網路介面名稱</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/etc/systemd/network/10-ethusb0.link</span></span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">[Match]</span><br><span class="line">MACAddress=00:00:00:00:00:00            <span class="comment">#卡號</span></span><br><span class="line"></span><br><span class="line">[Link]</span><br><span class="line">Description=USB to Ethernet Adapter        <span class="comment">#這張網路卡的說明</span></span><br><span class="line">Name=ethusb0                            <span class="comment">#介面名字</span></span><br></pre></td></tr></table></figure><p>想建立多張網卡的話就建立三個檔案分開定義卡號就好了</p><h2 id="升級系統packages"><a class="markdownIt-Anchor" href="#升級系統packages"></a> 升級系統packages</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br></pre></td></tr></table></figure><h2 id="安裝程式package"><a class="markdownIt-Anchor" href="#安裝程式package"></a> 安裝程式package</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vim <span class="comment">#安裝vim</span></span><br></pre></td></tr></table></figure><h2 id="尋找package"><a class="markdownIt-Anchor" href="#尋找package"></a> 尋找package</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum search python <span class="comment">#尋找所有名字裡有python的package</span></span><br></pre></td></tr></table></figure><h2 id="掛載smb分享的檔案"><a class="markdownIt-Anchor" href="#掛載smb分享的檔案"></a> 掛載SMB分享的檔案</h2><p>基本上會把docker的volume檔案夾先mount上NAS上的備份用資料夾,這樣可以</p><ol><li>簡單備份</li><li>減少PhotonOS的HDD空間需求</li><li>針對某些需要NAS上檔案的docker服務可以直接access</li></ol><p><a href="https://wiki.centos.org/zh-tw/TipsAndTricks/WindowsShares">參考資料</a></p><h3 id="cifs-utils"><a class="markdownIt-Anchor" href="#cifs-utils"></a> Cifs-utils</h3><p>基本上我的音樂檔案都是放在NAS上面,雖然可以透過NFS掛在機器上,但是同理也可以用SMB/Cifs掛載</p><p>在PhotonOS上可以利用yum安裝</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y cifs-utils</span><br></pre></td></tr></table></figure><p>然後修改加入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/etc/fstab</span></span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">\\winbox\getme /mnt/win cifs user,uid=500,rw,noauto,suid,credentials=/root/secret 0 0</span><br></pre></td></tr></table></figure><p>以及</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/root/secert</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">username=sushi    <span class="comment">#SMB ID</span></span><br><span class="line">password=yummy    <span class="comment">#SMB ID的Password</span></span><br></pre></td></tr></table></figure><p>記得<code>/root/secert</code>的權限改成0400</p><h3 id="cifs-utils-autofs"><a class="markdownIt-Anchor" href="#cifs-utils-autofs"></a> Cifs-utils + autofs</h3><p><s>這個可以自動加卸載</s>這個在photonOS上測試無效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y autofs</span><br></pre></td></tr></table></figure><p>增加到</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/etc/auto.master</span></span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">/mymount /etc/auto.mymount</span><br></pre></td></tr></table></figure><p>然後編輯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/etc/auto.mymount</span></span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">winbox  -fstype=cifs,rw,noperm,credentials=/root/secret.txt ://winbox/getme</span><br></pre></td></tr></table></figure><p>有任何使用到/mymount的動作就會自動掛上</p><h3 id="使用systemd開機自動掛載"><a class="markdownIt-Anchor" href="#使用systemd開機自動掛載"></a> 使用Systemd開機自動掛載</h3><p>因為/etc/fstab的auto比網路還快就啟動,所以最保險的方法還是建立systemd的service,其他的方法基本上都無效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">＃/etc/systemd/system/mount.service</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">[Unit]</span><br><span class="line">Description=mount CIFS</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/bin/mount -a</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>重點是要定義<code>After=network.target</code>這樣才會在有網路後進行</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;由於打算把所有的網路服務都逐步改成docker的方式,所以打算把底層的系統也換成Vmware針對docker等容器特化版的Linux - PhotoOS&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="PhotonOS &amp; Docker Basic" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/PhotonOS-Docker-Basic/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>Basic Tools for Docker</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/PhotonOS%20&amp;%20Docker%20Basic/2-Basic%20Tools/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/PhotonOS%20&amp;%20Docker%20Basic/2-Basic%20Tools/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>剛裝好的PhotonOS設定完基本後就是一些Docker相關的基本</p><span id="more"></span><h1 id="basic-tools"><a class="markdownIt-Anchor" href="#basic-tools"></a> Basic Tools</h1><h3 id="docker-compose"><a class="markdownIt-Anchor" href="#docker-compose"></a> Docker-compose</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安裝python-pip</span></span><br><span class="line">yum install python3-pip</span><br><span class="line"><span class="comment">#安裝docke-compose</span></span><br><span class="line">pip3 install docker-compose</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;剛裝好的PhotonOS設定完基本後就是一些Docker相關的基本&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="PhotonOS &amp; Docker Basic" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/PhotonOS-Docker-Basic/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>Ansible Environment Setup</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Ansible/Basic%20configuration/2-Setup/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Ansible/Basic%20configuration/2-Setup/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>安裝完Ansible後還要進行基礎的設定之後才能使用</p><span id="more"></span><h1 id="basic-configuration"><a class="markdownIt-Anchor" href="#basic-configuration"></a> Basic Configuration</h1><h2 id="ssh-key-preparation"><a class="markdownIt-Anchor" href="#ssh-key-preparation"></a> SSH key preparation</h2><p>基本上雖然可以用<code>--ask-pass</code>指令輸入密碼來操作,但是實際上還是有ssh key比較簡單,詳細的部份就放在<a href="https://kiwi0093.github.io/wiki/wiki/Linux/Tips/SSH/1-ssh_command/">SSH Commands | Kiwi's Wiki</a></p><h2 id="etcansibleansiblecfg"><a class="markdownIt-Anchor" href="#etcansibleansiblecfg"></a> /etc/ansible/ansible.cfg</h2><p>在範例中可以用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-config init --disable-all &gt; /etc/ansible/ansible.cfg</span><br></pre></td></tr></table></figure><p>來建立一個預設全部都關掉的cfg檔,又或是直接手動建立如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">＃/etc/ansible/ansible.cfg</span><br><span class="line">[defaults]                                    <span class="comment"># 定義整個section是defualt</span></span><br><span class="line">inventory=/etc/ansible/hosts                <span class="comment"># 定義inventory是要讀哪個檔,預設就是/etc/ansible/hosts</span></span><br><span class="line">private_key_file=/location/private.key        <span class="comment"># 定義預設連線時要用哪個ssh private key(若不打算用Key pair不用設定)</span></span><br><span class="line">remote_user=USER_on_server                    <span class="comment"># 定義預設連線的USER,因為一般的Linux/FreeBSD Server都不喜歡用root直接連進去,所以會用其他使用者</span></span><br></pre></td></tr></table></figure><p>基本上可以在<code>hosts</code>裡面針對不同的host(或是host group)進行設定,所以不一定需要在<code>ansible.cfg</code>內去設定<code>remote_user</code>或是<code>private_key_file</code>, 但是需要設定<code>inventory</code>位置</p><h2 id="hosts"><a class="markdownIt-Anchor" href="#hosts"></a> hosts</h2><h3 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h3><p><a href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">Ansible official document - How to build Inventory</a></p><h3 id="基本語法"><a class="markdownIt-Anchor" href="#基本語法"></a> 基本語法</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[tag1]</span></span><br><span class="line">server1.example.com</span><br><span class="line"><span class="section">[tag2]</span></span><br><span class="line">server2.example.com</span><br><span class="line"><span class="section">[tag3]</span></span><br><span class="line">server<span class="section">[a:z]</span>.example.com</span><br><span class="line"><span class="section">[tag4]</span></span><br><span class="line">192.168.0.101</span><br></pre></td></tr></table></figure><p>上述的意思為有四個<code>tag</code>,一個是<code>tag1</code>有一台<code>server1</code>, <code>tag2</code>有一台<code>server2</code>,<code>tag3</code>有<code>servera.example.com,serverb.example.com...serverz.example.com</code>等26台server.<code>tag4</code>是ip表示的server</p><h3 id="群組-children"><a class="markdownIt-Anchor" href="#群組-children"></a> 群組 :children</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[group1:children]</span></span><br><span class="line">tag1</span><br><span class="line">tag2</span><br><span class="line"></span><br><span class="line"><span class="section">[tag1]</span></span><br><span class="line">server1.example.com</span><br><span class="line"><span class="section">[tag2]</span></span><br><span class="line">server2.example.com</span><br><span class="line"><span class="section">[tag3]</span></span><br><span class="line">server<span class="section">[a:z]</span>.example.com</span><br><span class="line"><span class="section">[tag4]</span></span><br><span class="line">192.168.0.101</span><br></pre></td></tr></table></figure><p>有一個群組裡面包括了<code>tag1</code>&amp;<code>tag2</code>,這個指令可以群組裡面包含群組弄成很多層</p><h3 id="變數-vars"><a class="markdownIt-Anchor" href="#變數-vars"></a> 變數 :vars</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[group1:children]</span></span><br><span class="line">tag1</span><br><span class="line">tag2</span><br><span class="line"></span><br><span class="line"><span class="section">[tag1]</span></span><br><span class="line">server1.example.com <span class="attr">ansible_user</span>=myuser</span><br><span class="line"><span class="section">[tag2]</span></span><br><span class="line">server2.example.com</span><br><span class="line"><span class="section">[tag3]</span></span><br><span class="line">server<span class="section">[a:z]</span>.example.com</span><br><span class="line"><span class="section">[tag4]</span></span><br><span class="line">192.168.0.101</span><br><span class="line"></span><br><span class="line"><span class="section">[tag3:vars]</span></span><br><span class="line"><span class="attr">ansible_passwd</span>=mypassword</span><br></pre></td></tr></table></figure><p>這裡設定了單項變數<code>ansible_user=myuser</code>在<code>server1</code>以及整體變數<code>ansible_passwd=mypassword</code>給<code>tag3</code>所有的機器上</p><h3 id="參考範例"><a class="markdownIt-Anchor" href="#參考範例"></a> 參考範例</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 設定localhost給在Localhost上使用的,主要是ansible-pull這種需要設定本機才需要</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要先弄個[]定義個名字</span></span><br><span class="line"><span class="section">[Desktop]</span>                                   </span><br><span class="line"><span class="comment"># 這裡不用ip而是用localhost來定義</span></span><br><span class="line">localhost                                   </span><br><span class="line"><span class="comment"># 定義[Desktop]的相關變數</span></span><br><span class="line"><span class="section">[Desktop:vars]</span>                              </span><br><span class="line"><span class="comment"># 有些python3的位置不是預設的（例如Manjaro)所以手動指定</span></span><br><span class="line"><span class="attr">ansible_python_interpreter</span>=/usr/bin/python3</span><br><span class="line"><span class="comment"># 指定localhost的連線方式不使用ssh而是local </span></span><br><span class="line"><span class="attr">ansible_connection</span>=local</span><br><span class="line"></span><br><span class="line"><span class="comment"># 這是用一個大集合包括小集合的概念</span></span><br><span class="line"><span class="section">[Oracle_Cloud:children]</span></span><br><span class="line">Oracle_Private</span><br><span class="line">Oracle_Friend</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定義其中一個</span></span><br><span class="line"><span class="section">[Oracle_Private]</span></span><br><span class="line"><span class="comment"># 可以是以下這種格式</span></span><br><span class="line"><span class="comment"># 別名 ansible_ssh_host=XXX.XXX.XXX.XXX or my.server.domain</span></span><br><span class="line">oci1 <span class="attr">ansible_ssh_host</span>=xxx.xxx.xxx.xxx</span><br><span class="line">oci2 <span class="attr">ansible_ssh_host</span>=xxx.xxx.xxx.xxx</span><br><span class="line">oci3 <span class="attr">ansible_ssh_host</span>=xxx.xxx.xxx.xxx</span><br><span class="line"></span><br><span class="line"><span class="section">[Oracle_Friend]</span></span><br><span class="line">oci4 <span class="attr">ansible_ssh_host</span>=xxx.xxx.xxx.xxx</span><br><span class="line">oci5 <span class="attr">ansible_ssh_host</span>=xxx.xxx.xxx.xxx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">[Oracle_Cloud:vars]</span></span><br><span class="line"><span class="comment"># 可以個別指定python</span></span><br><span class="line"><span class="attr">ansible_python_interpreter</span>=/usr/bin/python3</span><br><span class="line"><span class="comment"># 可以指定這個群組的連線account是誰</span></span><br><span class="line"><span class="attr">ansible_ssh_user</span>=UserNameYouUsing</span><br><span class="line"><span class="comment"># 如前面說的可以指定對應的Private key</span></span><br><span class="line"><span class="attr">ansible_ssh_private_key_file</span>=/where/you/.ssh/the.key </span><br></pre></td></tr></table></figure><p>基本上<code>hosts</code>或該說<code>inventory</code>設定對於ansible來說是非常重要的定義，因為這個檔案基本上定義了你所有需要被納管的<code>remote node</code>資訊所以不要沒事把連同這個檔案在內的ansible設定放在public accessable repo內</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;安裝完Ansible後還要進行基礎的設定之後才能使用&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Ansible" scheme="http://kiwi0093.github.io/wiki/categories/Network/Ansible/"/>
    
    <category term="Basic configuration" scheme="http://kiwi0093.github.io/wiki/categories/Network/Ansible/Basic-configuration/"/>
    
    
    <category term="Linux" scheme="http://kiwi0093.github.io/wiki/tags/Linux/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="VPS" scheme="http://kiwi0093.github.io/wiki/tags/VPS/"/>
    
    <category term="Ansible" scheme="http://kiwi0093.github.io/wiki/tags/Ansible/"/>
    
  </entry>
  
  <entry>
    <title>Ansible Intro &amp; Install</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Ansible/Basic%20configuration/1-Intro/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Ansible/Basic%20configuration/1-Intro/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p><strong>Ansible</strong>是一個Redhat支持開發的<strong>IT Automation</strong>工具, 基礎是python3+ssh</p><span id="more"></span><h2 id="ansible"><a class="markdownIt-Anchor" href="#ansible"></a> Ansible</h2><h3 id="push-mode"><a class="markdownIt-Anchor" href="#push-mode"></a> Push mode</h3><p>這是Ansible的基本功用由一台安裝Ansible的機器push指令到Inventory的機器上一次性進行所有的同步指令進行管理</p><h4 id="ad-hoc指令"><a class="markdownIt-Anchor" href="#ad-hoc指令"></a> Ad-Hoc指令</h4><p>這是一次性的指令基本用法是</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible [pattern] -m [module] -a <span class="string">&quot;[module options]&quot;</span></span><br></pre></td></tr></table></figure><h4 id="playbook"><a class="markdownIt-Anchor" href="#playbook"></a> Playbook</h4><p>這個可以視為是事先寫好的script可以讓Ansible直接依照該Playbook去跑複雜的動作進行管理後續會把自己寫的一部分整理起來</p><h3 id="pull-mode"><a class="markdownIt-Anchor" href="#pull-mode"></a> Pull Mode</h3><p>這個是使用<code>ansible-pull</code>指令,將某地的Playbook拉到本機上套用,很適合用來進行單機的自動環境設定,像我這種會日益增加Linux機台的人很適合寫好playbook然後採用**<em>ansible-pull+Github</em>**的組合去儲存我的各種機器設定,缺點就是變成每一台機器都得要安裝ansible不然的話無法套用(push mode不用每台都安裝也可以跑)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ansible-pull -U https://your.git.server/user/repo playbook-you-want.yml</span><br></pre></td></tr></table></figure><p>這樣就可以指定要pull哪個playbook來使用</p><h2 id="安裝"><a class="markdownIt-Anchor" href="#安裝"></a> 安裝</h2><p>安裝非常的簡單就我自己常用的Arch系與Debian/Ubuntu系的機器都是一行指令安裝完成</p><p>Arch/Manjaro</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S ansible</span><br></pre></td></tr></table></figure><p>Debian/Ubuntu</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install ansible</span><br></pre></td></tr></table></figure><h3 id="基本連線"><a class="markdownIt-Anchor" href="#基本連線"></a> 基本連線</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &lt;IP or name&gt; --ask-pass -m [module]</span><br></pre></td></tr></table></figure><p>若是使用ssh key的話就不需要<code>--ask-pass</code>參數來要求手動輸入ssh password</p><p>有些Server會check host ssh key,所以可以去ansible.cfg裡面加上<code>host_key_checking = False</code></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Ansible&lt;/strong&gt;是一個Redhat支持開發的&lt;strong&gt;IT Automation&lt;/strong&gt;工具, 基礎是python3+ssh&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Ansible" scheme="http://kiwi0093.github.io/wiki/categories/Network/Ansible/"/>
    
    <category term="Basic configuration" scheme="http://kiwi0093.github.io/wiki/categories/Network/Ansible/Basic-configuration/"/>
    
    
    <category term="Linux" scheme="http://kiwi0093.github.io/wiki/tags/Linux/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="VPS" scheme="http://kiwi0093.github.io/wiki/tags/VPS/"/>
    
  </entry>
  
  <entry>
    <title>Ansible Playbook &amp; Roles</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/Network/Ansible/Playbook/1.playbook/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/Network/Ansible/Playbook/1.playbook/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>其實ansible有很完整的官方文件可以學習,不過我就把我自己會用的方法寫成筆記給自己做個memo</p><span id="more"></span><h1 id="結構"><a class="markdownIt-Anchor" href="#結構"></a> 結構</h1><p>看ansible官方的文件,一開始都會有一個playbook要包山包海的的念頭,不過不是我在說,一個包山包海的Playbook不僅難寫難維護,還很容易錯,所以我個人會建議盡可能的拆分成一個一個的模組這樣維護上會比較簡單,寫的時候也比較容易</p><h2 id="個人喜愛的ansible框架"><a class="markdownIt-Anchor" href="#個人喜愛的ansible框架"></a> 個人喜愛的ansible框架</h2><p><img src="https://raw.githubusercontent.com/Kiwi0093/graph/master/img/ansible_construction.PNG" alt="" /></p><h4 id="簡單說明"><a class="markdownIt-Anchor" href="#簡單說明"></a> 簡單說明</h4><p>首先,對於自己的實力以及實際在跑得ansible playbook的效率的平衡,比較複雜的工作我會採用<code>shell script + ansible</code>的方式來進行, 因為是靠已經寫好的<code>shell script</code>trigger ansible playbook, 自然也就不用<code>one playbook rule them all</code>的思維來寫Playbook</p><p>基於上面的邏輯，所以Playbook自然就會focus在單一目的來編寫減少大量複雜而且容易出錯的條件判斷</p><p>在範例中,我會建立一個專門給manajro用的playbook,用途是用來setup我的manjaro desktop, 然而這個Playbook裡面會長這樣</p><h5 id="playbook-level"><a class="markdownIt-Anchor" href="#playbook-level"></a> Playbook Level</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">localhost</span></span><br><span class="line">  <span class="attr">connection:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">no</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">base</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">neovim</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">desktop</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">brave</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">fcitx</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ulauncher</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">remmina</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">marktext</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ssh-key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">wireguard</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kde</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">cinnamon</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">gnome</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">xfce</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">localhost</span></span><br><span class="line">  <span class="attr">connection:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">clean</span> <span class="string">up</span> <span class="string">package</span> <span class="string">cache</span> <span class="string">|</span> <span class="string">Archlinux</span> <span class="string">Family</span></span><br><span class="line">      <span class="attr">command:</span> <span class="string">pacman</span> <span class="string">-Scc</span> <span class="string">--noconfirm</span></span><br></pre></td></tr></table></figure><p>首先這個playbook裡面有兩個play, 一個定義了一堆roles, 另外一個則是要求清空安裝的cache檔,老實說第二個play是不需要的,真的需要的只有第一個play</p><p>第一個play與其他文件上講的差異很大,基本上沒有任何task也沒任何條件判別就是很單純的定義localhost要有這些<code>roles</code></p><p>這裡就是好的地方,因為我可以簡單定義這個所謂的本機需要多少子項在內，然後有重複的子項就可以回收使用</p><h4 id="roles"><a class="markdownIt-Anchor" href="#roles"></a> Roles</h4><p>基本上roles就是一堆task的內容定義，結構是<code>roles/roles_name/files</code>跟<code>roles/roles_name/tasks</code>然後會自然呼叫<code>roles/roles_name/tasks/main.yml</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">System</span> <span class="string">ZSH</span> <span class="string">Powerlevel</span> <span class="string">&amp;</span> <span class="string">Environment</span> <span class="string">Setting</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">zsh</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">ansible.posix.synchronize:</span> <span class="string">src=&#123;&#123;</span> <span class="string">item.src</span> <span class="string">&#125;&#125;</span> <span class="string">dest=&#123;&#123;</span> <span class="string">item.dest</span> <span class="string">&#125;&#125;</span></span><br><span class="line">  <span class="attr">with_items:</span></span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">src:</span> <span class="string">&#x27;files/zshrc&#x27;</span>, <span class="attr">dest:</span> <span class="string">&#x27;/root/.zshrc&#x27;</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">src:</span> <span class="string">&#x27;files/zshrc&#x27;</span>, <span class="attr">dest:</span> <span class="string">&#x27;/home/kiwi/.zshrc&#x27;</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">src:</span> <span class="string">&#x27;files/tmux.conf&#x27;</span>, <span class="attr">dest:</span> <span class="string">&#x27;/home/kiwi/.tmux.conf&#x27;</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">src:</span> <span class="string">&#x27;files/tmux.conf.local&#x27;</span>, <span class="attr">dest:</span> <span class="string">&#x27;/home/kiwi/.tmux.conf.local&#x27;</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">src:</span> <span class="string">&#x27;files/tmux.conf&#x27;</span>, <span class="attr">dest:</span> <span class="string">&#x27;/root/.tmux.conf&#x27;</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">src:</span> <span class="string">&#x27;files/tmux.conf.local&#x27;</span>, <span class="attr">dest:</span> <span class="string">&#x27;/root/.tmux.conf.local&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><p>簡單提一下,這個roles基本上就是把檔案從<code>files</code>拷貝到本機/remote的某個地方,可以看的出來層級就等於是playbook內的<code>tasks:</code></p><p>另一種呼叫是放在同階層的yml檔案利用語法是</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="string">-name:</span></span><br><span class="line"></span><br><span class="line">  <span class="string">.....</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">inculde:</span> <span class="string">XXX.yml</span></span><br></pre></td></tr></table></figure><p>他就會讀進跟Roles內的yml同階的文件(一樣是<code>- name:</code>開頭的)</p><h1 id="結論"><a class="markdownIt-Anchor" href="#結論"></a> 結論</h1><p>若是很單純想要透過模組化來進行重複利用的就用roles功能，或是用inculde機能去載入對應的task item都可以端看寫的人想要怎麼分</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;其實ansible有很完整的官方文件可以學習,不過我就把我自己會用的方法寫成筆記給自己做個memo&lt;/p&gt;</summary>
    
    
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/categories/Network/"/>
    
    <category term="Ansible" scheme="http://kiwi0093.github.io/wiki/categories/Network/Ansible/"/>
    
    <category term="Playbook" scheme="http://kiwi0093.github.io/wiki/categories/Network/Ansible/Playbook/"/>
    
    
    <category term="Linux" scheme="http://kiwi0093.github.io/wiki/tags/Linux/"/>
    
    <category term="Network" scheme="http://kiwi0093.github.io/wiki/tags/Network/"/>
    
    <category term="VPS" scheme="http://kiwi0093.github.io/wiki/tags/VPS/"/>
    
    <category term="Ansible" scheme="http://kiwi0093.github.io/wiki/tags/Ansible/"/>
    
  </entry>
  
  <entry>
    <title>Certbot</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/1-certbot/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/1-certbot/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>雖然可以用這個方法來代直接安裝certbot,不過後來用方Nginx Proxy Manager</p><span id="more"></span><h1 id="certbot"><a class="markdownIt-Anchor" href="#certbot"></a> Certbot</h1><h5 id="install"><a class="markdownIt-Anchor" href="#install"></a> Install</h5><p>參考<a href="https://certbot.eff.org/docs/install.html#running-with-docker">Certbot的Doc</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -it --<span class="built_in">rm</span> --name certbot -v <span class="string">&quot;/etc/letsencrypt:/etc/letsencrypt&quot;</span> -v <span class="string">&quot;/var/lib/letsencrypt:/var/lib/letsencrypt&quot;</span> \</span><br><span class="line">            certbot/certbot certonly</span><br></pre></td></tr></table></figure><p>想要對於指定IP有不同Domain的話可以再加上<code>-p 你要的ip:80:80 -p 你要的ip:443:443</code>這一個參數這樣就可以對應了</p><h5 id="auto-renew"><a class="markdownIt-Anchor" href="#auto-renew"></a> Auto Renew</h5><p>在crontab裡面加上</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 0 * * * docker run --<span class="built_in">rm</span> -v /etc/letsencrypt:/etc/letsencrypt -ti certbot/certbot renew</span><br></pre></td></tr></table></figure><p>就好了</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;雖然可以用這個方法來代直接安裝certbot,不過後來用方Nginx Proxy Manager&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="Service Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/"/>
    
    <category term="Common" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/Common/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>Nginx Proxy Manager</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/3-nginx-proxy-manager/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/3-nginx-proxy-manager/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>這個東西是等於是一個Web GUI界面的Nginx plug in,雖然他<s>要用到SQL DB</s>現在可以使用sqlite,但是說穿了就是把nginx的設定改成圖形化並且強化反向代理的設定以及加上certbot的功能不用自己再手動處理SSL KEY（不過我還是希望他可以直接load進已經有的key)</p><span id="more"></span><h1 id="基本做法"><a class="markdownIt-Anchor" href="#基本做法"></a> 基本做法</h1><h2 id="mariadb"><a class="markdownIt-Anchor" href="#mariadb"></a> <s>MariaDB</s></h2><p><s>基本上可以沿用Librenms那篇裡面已經建好的mariadb,建個帳號跟database就好,我實際上的作法是直接用phpAdmin建一個就解決了</s></p><h2 id="sqlite"><a class="markdownIt-Anchor" href="#sqlite"></a> Sqlite</h2><p>現在什麼都不設定就預設會使用<code>sqlite</code>老實說對於現在我喜歡把各項服務與對應的DB分開建立的方法來說非常合適（尤其NPM是很輕量的DB需求…）</p><h2 id="nginx-proxy-manager"><a class="markdownIt-Anchor" href="#nginx-proxy-manager"></a> Nginx Proxy Manager</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#docker-compose.yml</span></span><br><span class="line"><span class="string">--------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&#x27;jc21/nginx-proxy-manager:latest&#x27;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;80:80&#x27;</span>            <span class="comment">#這個是正常的http</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;81:81&#x27;</span>            <span class="comment">#這個是管理界面</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;443:443&#x27;</span>        <span class="comment">#這個是正常的https</span></span><br><span class="line"><span class="comment"># 註解掉就會使用對應的sqlite</span></span><br><span class="line"><span class="comment">#    environment:</span></span><br><span class="line"><span class="comment">#      DB_MYSQL_HOST: &quot;$&#123;your_db_ip&#125;&quot;</span></span><br><span class="line"><span class="comment">#      DB_MYSQL_PORT: 3306</span></span><br><span class="line"><span class="comment">#      DB_MYSQL_USER: &quot;npm&quot;</span></span><br><span class="line"><span class="comment">#      DB_MYSQL_PASSWORD: &quot;$&#123;your_passwd&#125;&quot;</span></span><br><span class="line"><span class="comment">#      DB_MYSQL_NAME: &quot;npm&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/lib/docker/volumes/nginx-proxy-manager/data:/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/letsencrypt:/etc/letsencrypt</span></span><br></pre></td></tr></table></figure><h1 id="使用方法"><a class="markdownIt-Anchor" href="#使用方法"></a> 使用方法</h1><ol><li>設定帳號</li></ol><p>架設好了之後先用預設的帳號密碼進入一進去他就會強迫你修改admin的帳號密碼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#預設的帳號密碼</span></span><br><span class="line">Email:    admin@example.com</span><br><span class="line">Password: changeme</span><br></pre></td></tr></table></figure><ol start="2"><li>注意事項<ul><li>他不能直接用已經申請好的key,得利用他的界面重新申請cert.</li><li>所有的DN主目錄不能是空的服務,所以我才會弄個heimdall來當首頁</li><li>所有特殊設定請在custom location -&gt; location旁的齒輪內貼上,不然不會動</li></ul></li></ol><h1 id="曾經的問題"><a class="markdownIt-Anchor" href="#曾經的問題"></a> 曾經的問題</h1><p>為什麼講曾經…因為後來一堆服務我都改用<code>Traefik</code>來做SSL+Reserve Proxy</p><p>所以就變成曾經…</p><h2 id="calibre-web問題"><a class="markdownIt-Anchor" href="#calibre-web問題"></a> Calibre-web問題</h2><p>貼上下列敘述後就可以動了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxy_bind <span class="variable">$server_addr</span>;</span><br><span class="line">proxy_set_header Host <span class="variable">$http_host</span>;</span><br><span class="line">proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">proxy_set_header X-Scheme <span class="variable">$scheme</span>;</span><br><span class="line">proxy_set_header X-Script-Name /<span class="variable">$&#123;your_location&#125;</span>;</span><br></pre></td></tr></table></figure><h2 id="portainer-ce問題"><a class="markdownIt-Anchor" href="#portainer-ce問題"></a> Portainer-ce問題</h2><p>目前還沒找到讓portainer-ce在location下正常運作的方法,其實可以很奢侈的每一種服務都掛一個DN的方法來做virtual host的作法應該就可以了</p><h1 id="現在的問題"><a class="markdownIt-Anchor" href="#現在的問題"></a> 現在的問題</h1><p>現在的主要應用是拿來做內部服務的轉址,在內部DNS設定好的情況下,只有一個重點達成就可以直接以<code>container name</code>來進行轉址（連port都不用maping)</p><h2 id="重點"><a class="markdownIt-Anchor" href="#重點"></a> 重點</h2><p>讓<code>Nginx Proxy Manager</code>跟其他需要他轉址的container在同一個docker network底下</p><p>然後就可以</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://emby.private --&gt; http:// emby port 8096</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;這個東西是等於是一個Web GUI界面的Nginx plug in,雖然他&lt;s&gt;要用到SQL DB&lt;/s&gt;現在可以使用sqlite,但是說穿了就是把nginx的設定改成圖形化並且強化反向代理的設定以及加上certbot的功能不用自己再手動處理SSL KEY（不過我還是希望他可以直接load進已經有的key)&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="Service Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/"/>
    
    <category term="Common" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/Common/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>Isso comment system for Hexo Blog</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/4-isso/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Common/4-isso/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>繞了一圈最佳的Blog評論系統就在身邊…改用Isso吧</p><span id="more"></span><h1 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h1><p><a href="https://theme-next.js.org/docs/third-party-services/comments#Overview">Hexo-theme-Next的comment說明</a></p><p><a href="https://posativ.org/isso/docs/quickstart/#configuration">Isso QuickStart</a></p><h1 id="作法"><a class="markdownIt-Anchor" href="#作法"></a> 作法</h1><h2 id="docker-composeyml內容"><a class="markdownIt-Anchor" href="#docker-composeyml內容"></a> Docker-compose.yml內容</h2><p><em>更新於2022/7/26</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.7&quot;</span></span><br><span class="line">services:</span><br><span class="line">  isso:</span><br><span class="line">    image: ghcr.io/isso-comments/isso:latest</span><br><span class="line">    container_name: isso</span><br><span class="line">    environment:</span><br><span class="line">      - PUID=1000</span><br><span class="line">    volumes:</span><br><span class="line">      - /var/lib/docker/volumes/isso/config:/config</span><br><span class="line">      - /var/lib/docker/volumes/isso/data:/db</span><br><span class="line">    restart: unless-stopped</span><br><span class="line">    networks:</span><br><span class="line">      - traefik</span><br><span class="line">    labels:</span><br><span class="line">      traefik.enable: <span class="literal">true</span></span><br><span class="line">      traefik.http.routers.isso.rule: Host(`<span class="variable">$domain_you_like</span>`)</span><br><span class="line">      traefik.http.routers.isso.tls: <span class="literal">true</span></span><br><span class="line">      traefik.http.routers.isso.tls.certresolver: myresolver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  traefik:</span><br><span class="line">    external: <span class="literal">true</span></span><br><span class="line">    name: web-service</span><br></pre></td></tr></table></figure><p>基本上這種寫法需要先去<code>touch</code>一個<code>isso.conf</code>檔案並且記得權限要讓定義的PUID可以讀</p><h2 id="issoconf內容"><a class="markdownIt-Anchor" href="#issoconf內容"></a> isso.conf內容</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[general]</span><br><span class="line">dbpath = /db/$(databasename).db        <span class="comment">#這個檔名可以自己定義</span></span><br><span class="line">host = https://$(your_Blog_domain)        <span class="comment">#這裡記得要設定Blog的網址</span></span><br><span class="line">[server]</span><br><span class="line">listen = http://0.0.0.0:8080            <span class="comment">#這裡設定的Port就是docker-compose.yml裡面要定義的容器內的port</span></span><br><span class="line">[guard]</span><br><span class="line">enabled = <span class="literal">true</span></span><br><span class="line">ratelimit = 2</span><br><span class="line">direct-reply = 3</span><br><span class="line">reply-to-self = <span class="literal">false</span></span><br><span class="line">require-author = <span class="literal">true</span></span><br><span class="line">require-email = <span class="literal">true</span></span><br><span class="line">[moderation]                            <span class="comment">#這個是需要不需要先審查過再貼出,要的就改成true</span></span><br><span class="line">enabled = <span class="literal">false</span></span><br><span class="line">purge-after = 30d</span><br><span class="line">[admin]                                     <span class="comment">#這是設定要不要管理員</span></span><br><span class="line">enabled = <span class="literal">false</span></span><br><span class="line">password = strong-password</span><br></pre></td></tr></table></figure><h2 id="外部轉出"><a class="markdownIt-Anchor" href="#外部轉出"></a> 外部轉出</h2><p><font color=red><del>跑起來後用nginx-proxy-manager去弄個外部的連接位置然後就可以去設定Next了</del></font></p><p>有強大的Traefik…什麼都不用擔心…</p><h2 id="next設定"><a class="markdownIt-Anchor" href="#next設定"></a> Next設定</h2><p>在_config.next.yml裡面加上</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Comments Settings</span></span><br><span class="line"><span class="comment"># See: https://theme-next.js.org/docs/third-party-services/comments</span></span><br><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Multiple Comment System Support</span></span><br><span class="line">comments:</span><br><span class="line">  <span class="comment"># Available values: tabs | buttons</span></span><br><span class="line">  style: tabs</span><br><span class="line">  <span class="comment"># Choose a comment system to be displayed by default.</span></span><br><span class="line">  <span class="comment"># Available values: disqus | disqusjs | changyan | livere | gitalk | utterances</span></span><br><span class="line">  active: isso </span><br><span class="line">  <span class="comment"># Setting `true` means remembering the comment system selected by the visitor.</span></span><br><span class="line">  storage: <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Lazyload all comment systems.</span></span><br><span class="line">  lazyload: <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Modify texts or order for any naves, here are some examples.</span></span><br><span class="line">  nav:</span><br><span class="line">    <span class="comment">#disqus:</span></span><br><span class="line">    <span class="comment">#  text: Load Disqus</span></span><br><span class="line">    <span class="comment">#  order: -1</span></span><br><span class="line">    <span class="comment">#gitalk:</span></span><br><span class="line">    <span class="comment">#  order: -2</span></span><br><span class="line">.....</span><br><span class="line">.....</span><br><span class="line"><span class="comment"># Isso</span></span><br><span class="line"><span class="comment"># For more information: https://posativ.org/isso/</span></span><br><span class="line">isso: https://<span class="variable">$domain_you_like</span>/</span><br></pre></td></tr></table></figure><p>然後<code>hexo d -g</code>就好了</p><h1 id="注意事項"><a class="markdownIt-Anchor" href="#注意事項"></a> 注意事項</h1><ul><li><p>我用Traefik跑<code>https</code>的話data-isso就用<code>https://$domain_you_like/</code>來取代教學裡面的<code>//$domain_you_like/</code></p></li><li><p><code>hexo s</code>在本機跑的時候是看不到評論的…一定要<code>hexo g -d</code>拋到github上面才看得到…</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;繞了一圈最佳的Blog評論系統就在身邊…改用Isso吧&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="Service Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/"/>
    
    <category term="Common" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/Common/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
    <category term="Blog" scheme="http://kiwi0093.github.io/wiki/tags/Blog/"/>
    
  </entry>
  
  <entry>
    <title>WireGuard</title>
    <link href="http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Home%20Lab/1-Wireguard/"/>
    <id>http://kiwi0093.github.io/wiki/wiki/VM&amp;Container/Service%20Container/Home%20Lab/1-Wireguard/</id>
    <published>2024-03-21T02:36:21.146Z</published>
    <updated>2024-03-21T02:36:21.146Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h1><p>在中國以外的地方就不使用V2Ray了,改用Wireguard</p><span id="more"></span><h1 id="參考資料"><a class="markdownIt-Anchor" href="#參考資料"></a> 參考資料</h1><ul><li><a href="https://wiki.archlinux.org/title/WireGuard#NetworkManager">WireGuard-ArchWiki</a></li><li><a href="https://notes.wadeism.net/linux/680/">WireGuard VPN 設定與使用教學</a></li><li><a href="https://www.stavros.io/posts/how-to-configure-wireguard/">How to easily configure WireGuard</a></li><li><a href="https://www.wogong.net/blog/2019/01/how-to-configure-wireguard">How to easily configure WireGuard的翻譯</a></li></ul><h1 id="作法"><a class="markdownIt-Anchor" href="#作法"></a> 作法</h1><h2 id="docker-composeyml內容"><a class="markdownIt-Anchor" href="#docker-composeyml內容"></a> Docker-compose.yml內容</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.7&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  wireguard:</span><br><span class="line">    image: ghcr.io/linuxserver/wireguard</span><br><span class="line">    container_name: wireguard</span><br><span class="line">    cap_add:</span><br><span class="line">      - NET_ADMIN</span><br><span class="line">      - SYS_MODULE</span><br><span class="line">    environment:</span><br><span class="line">      - PUID=1000</span><br><span class="line">      - PGID=1000</span><br><span class="line">      - TZ=Asia/Taipei</span><br><span class="line">      - SERVERURL=<span class="variable">$&#123;your_IP_or_Domain&#125;</span></span><br><span class="line">      - SERVERPORT=<span class="variable">$&#123;Your_port&#125;</span></span><br><span class="line">      - PEERS=<span class="variable">$&#123;peer1_name&#125;</span>,<span class="variable">$&#123;peer2_name&#125;</span>,<span class="variable">$&#123;peer3_name&#125;</span></span><br><span class="line">      - PEERDNS=8.8.8.8</span><br><span class="line">      - INTERNAL_SUBNET=<span class="variable">$&#123;Subnet_you_want&#125;</span></span><br><span class="line">      - ALLOWEDIPS=<span class="variable">$&#123;connect_to_where_via_wireguard&#125;</span></span><br><span class="line">    volumes:</span><br><span class="line">      -  /var/lib/docker/volumes/wireguard/config:/config</span><br><span class="line">      - /lib/modules:/lib/modules</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="variable">$&#123;Your_port&#125;</span>:<span class="variable">$&#123;Your_port&#125;</span>/udp</span><br><span class="line">    sysctls:</span><br><span class="line">      - net.ipv4.conf.all.src_valid_mark=1</span><br><span class="line">    restart: unless-stopped</span><br></pre></td></tr></table></figure><h2 id="參數說明"><a class="markdownIt-Anchor" href="#參數說明"></a> 參數說明</h2><table><thead><tr><th>參數</th><th>定義內容</th></tr></thead><tbody><tr><td>SERVERURL</td><td>等於就是定義你的endpoint,你的外部IP或是Domain</td></tr><tr><td>SERVERPORT</td><td>定義要使用的udp port,基本上跟後面ports要mapping的以及你的最外側FW設定要能對的起來</td></tr><tr><td>PEERS</td><td>你要用的peers,可以直接用名字命名然後在docker-compose up的時候會自動生成</td></tr><tr><td>PEERDNS</td><td>在Wireguard環境中你要用的DNS ip</td></tr><tr><td>INTERNAL_SUBNET</td><td>預設的子網路,定義好後Server會用這個子網路的第一個IP,Peers就會依序用後面的</td></tr><tr><td>ALLOWEDIPS</td><td>這是你打算使用wireguard連上的範圍,0.0.0.0/0就是全流量走wireguard,可以定義一個subnet就只有這個subnet走wireguard</td></tr></tbody></table><h2 id="使用說明"><a class="markdownIt-Anchor" href="#使用說明"></a> 使用說明</h2><h3 id="android"><a class="markdownIt-Anchor" href="#android"></a> Android</h3><p>基本上就是安裝同名子的App然後刷QR code就可以用了,Linuxserver.io的這個image很貼心的會幫你產生只要</p><p><code>docker logs wireguard</code>就會看到各個peers的QR code,把圖片照下來或是存下來甚至是做了放到網頁上都可以（不過這個一個peer只允許一個連線也沒必要這樣）</p><h3 id="linuxmanjaro-21"><a class="markdownIt-Anchor" href="#linuxmanjaro-21"></a> Linux(Manjaro 21)</h3><p>有蠻多種方式可以使用的,可以單純用network-manager這個GUI程式直接設定（不過ip的部份因為他不吃DHCP,所以要手動設定）</p><p>或是可以用wg-quick的方式,甚至可以先把wg0.conf寫好都確定了在import到network-manager裡面</p><h4 id="wg-quick方式"><a class="markdownIt-Anchor" href="#wg-quick方式"></a> wg-quick方式</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S wireguard-tools</span><br></pre></td></tr></table></figure><p>需要先安裝module&amp;tools</p><p>然後</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /etc/wireguard</span><br><span class="line">sudo <span class="built_in">chmod</span> 750 /etc/wireguard</span><br><span class="line"><span class="built_in">cd</span> /etc/wireguard</span><br><span class="line">sudo <span class="built_in">umask</span> 077</span><br></pre></td></tr></table></figure><p>其實在docker的設定檔(default in my docker-compose.yml is /var/lib/docker/volumes/config)內就有已經可以用的設定檔你可以把整個peer_$(Name)抓下來放到<code>/etc/wireguard</code>內把過於複雜的檔名改一下,基本上你用XXX.conf這個XXX就是你的interface_name</p><p>確定都好了之後</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo wg-quick up XXX</span><br></pre></td></tr></table></figure><p>這樣就會預設去找在<code>/etc/wireguard/</code>內名叫XXX的XXX.conf</p><p>確認連線都ok後就好了</p><p>不連了就</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo wg-quick down XXX</span><br></pre></td></tr></table></figure><h4 id="把設定好的檔案import到network-manager"><a class="markdownIt-Anchor" href="#把設定好的檔案import到network-manager"></a> 把設定好的檔案import到Network-manager</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmcli connection import <span class="built_in">type</span> wireguard file /etc/wireguard/<span class="variable">$&#123;your_conf&#125;</span></span><br></pre></td></tr></table></figure><p>就好了之後就可以滑鼠來操作</p><h3 id="注意事項"><a class="markdownIt-Anchor" href="#注意事項"></a> 注意事項</h3><ul><li>AllowIPs</li></ul><p>若是你沒有在外側架設任何服務的話,是可以用0.0.0.0/0,這代表所有的封包都走wireguard從Server那邊出去,但是當你這樣設定的時候架在同個ip上的其他服務就會連不上,所以建議若你的網路上掛了其他服務,還是單純的定義某些區段走wireguard就好</p><ul><li>若你不是直接拿server上產生的檔案來用的話,那就要很注意設定的內容務必要正確</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Client設定範例</span></span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">[Interface]</span><br><span class="line">Address = 192.168.2.2＃這裡的ip要跟Server上設定的peer ip要一樣,不然會有問題</span><br><span class="line">PrivateKey = &lt;client<span class="string">&#x27;s privatekey&gt;＃這個private Key,是client的private key,基本上docker會幫你建一個,你若是要自己建務必要去改server端設定</span></span><br><span class="line"><span class="string">ListenPort = 21841#這個是你作server的時候port要用哪個</span></span><br><span class="line"><span class="string">DNS = 8.8.8.8#這個是你作為Server的時候DNS要用哪台</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Peer]</span></span><br><span class="line"><span class="string">PublicKey = &lt;server&#x27;</span>s publickey&gt;＃這個是Server端的public key</span><br><span class="line">Endpoint = &lt;server<span class="string">&#x27;s ip&gt;:51820#這個就是endpoint跟port</span></span><br><span class="line"><span class="string">AllowedIPs = 0.0.0.0/0, ::/0#這個就是定義你哪些要用wireguard連線</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h1&gt;
&lt;p&gt;在中國以外的地方就不使用V2Ray了,改用Wireguard&lt;/p&gt;</summary>
    
    
    
    <category term="VM&amp;Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/"/>
    
    <category term="Service Container" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/"/>
    
    <category term="Home Lab" scheme="http://kiwi0093.github.io/wiki/categories/VM-Container/Service-Container/Home-Lab/"/>
    
    
    <category term="VM" scheme="http://kiwi0093.github.io/wiki/tags/VM/"/>
    
    <category term="Container" scheme="http://kiwi0093.github.io/wiki/tags/Container/"/>
    
    <category term="VPN" scheme="http://kiwi0093.github.io/wiki/tags/VPN/"/>
    
  </entry>
  
</feed>
